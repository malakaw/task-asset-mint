[2021-06-16 09:21:15,071][INFO][zmaxx-etl.db-client] 
select  orderI.store_key , 
			   rds.name,   
                          # sum(zorder.order_price) as payment , 
                          # (sum(orderI.sku_pay) - sum(rdp.jj))/sum(orderI.sku_pay) as gross_profit,   
                          # (sum(orderI.sku_pay) - sum(rdp.jj)) as gross,                    
                           sum(orderI.sku_qty) as qty,
                           sum(rdpu.sl) as purchase_sl,
                           #sum(orderI.sku_pay)/sum(orderI.sku_qty) as unit_merchan_price,
                           sum(rdp.jj) as jj,
                           count(distinct(orderI.order_id))  as order_count,
                           #sum(orderI.sku_pay)/count(distinct(orderI.order_id)) as  unit_order_price,
                           sum(orderI.sku_qty)/count(distinct(orderI.order_id))  as  joint_rate,
                           #AVG(zorder.order_pay) as avg_order_pay,
                           #sum(orderI.sku_pay)/sum(orderI.sku_qty)  as unit_goods_price,
                           count(distinct(orderI.sku_id)) as sku_distinct_count,
                           count(distinct(zorder.customer_key)) as user_count
                   from order_item as orderI
                   left join  rd_product as rdp on rdp.id = orderI.sku_id 
                   left join  rd_store as rds on rds.`id` =  orderI.store_key
                   left join  rd_purchase  as rdpu on rdpu.market = orderI.store_key
		   left join  zmaxx_001.order as zorder on zorder.id =   orderI.order_id 	
                   where        orderI.order_source='redian'  
                           and  orderI.sku_pay>0                    
                           and  orderI.create_dt >=  '2021-05-11 00:00:00' 
                           and  orderI.create_dt <= '2021-05-11 23:00:00'
                           #and  p_stock.kcsl > 0
                   group by orderI.store_key ;


[2021-06-16 09:21:16,882][INFO][zmaxx-etl.db-client] 
select market as store_key ,sum(lsjje)*-1 as payment ,sum(zzk)*-1 as zzk ,sum(jj) as jj  from rd_pss where 
rq  >=  '2021-05-11 00:00:00'
and  rq <= '2021-05-11 23:00:00'
and ( type = 105 or type = 106)
group by market 


[2021-06-16 09:21:17,587][INFO][zmaxx-etl.db-client] 
    select market,sum(kcsl)  as kcsl from rd_product_stock where kcsl > 0 group by market 


[2021-06-16 09:21:17,705][INFO][zmaxx-etl.db-client] 
select  store_key, sum(CAST(sku_qty AS DECIMAL(12,2)) ) as sale_qty_30  from order_item where order_create > DATE_SUB('2021-05-11',INTERVAL 30 DAY)  group by store_key
[2021-06-16 09:21:18,128][INFO][zmaxx-etl.db-client] 
select store_key,COUNT(DISTINCT(customer_key)) as new_u,sum(order_price) as new_u_pay from zmaxx_001.order 
where  customer_key not in
(
select distinct(customer_key) as old_key from zmaxx_001.order   where      order_create  <= '2021-05-11 00:00:00'
)
and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:00:00'
group by store_key 


[2021-06-16 09:21:18,829][INFO][zmaxx-etl.db-client] 
select store_key,count(order_id) as user_null_count from zmaxx_001.order 
where customer_key = 0  and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:00:00'
group by store_key;


[2021-06-16 09:21:53,712][INFO][zmaxx-etl.db-client] 
select  orderI.store_key , 
			   rds.name,   
                          # sum(zorder.order_price) as payment , 
                          # (sum(orderI.sku_pay) - sum(rdp.jj))/sum(orderI.sku_pay) as gross_profit,   
                          # (sum(orderI.sku_pay) - sum(rdp.jj)) as gross,                    
                           sum(orderI.sku_qty) as qty,
                           sum(rdpu.sl) as purchase_sl,
                           #sum(orderI.sku_pay)/sum(orderI.sku_qty) as unit_merchan_price,
                           sum(rdp.jj) as jj,
                           count(distinct(orderI.order_id))  as order_count,
                           #sum(orderI.sku_pay)/count(distinct(orderI.order_id)) as  unit_order_price,
                           sum(orderI.sku_qty)/count(distinct(orderI.order_id))  as  joint_rate,
                           #AVG(zorder.order_pay) as avg_order_pay,
                           #sum(orderI.sku_pay)/sum(orderI.sku_qty)  as unit_goods_price,
                           count(distinct(orderI.sku_id)) as sku_distinct_count,
                           count(distinct(zorder.customer_key)) as user_count
                   from order_item as orderI
                   left join  rd_product as rdp on rdp.id = orderI.sku_id 
                   left join  rd_store as rds on rds.`id` =  orderI.store_key
                   left join  rd_purchase  as rdpu on rdpu.market = orderI.store_key
		   left join  zmaxx_001.order as zorder on zorder.id =   orderI.order_id 	
                   where        orderI.order_source='redian'  
                           and  orderI.sku_pay>0                    
                           and  orderI.create_dt >=  '2021-05-11 00:00:00' 
                           and  orderI.create_dt <= '2021-05-11 23:00:00'
                           #and  p_stock.kcsl > 0
                   group by orderI.store_key ;


[2021-06-16 09:21:54,486][INFO][zmaxx-etl.db-client] 
select market as store_key ,sum(lsjje)*-1 as payment ,sum(zzk)*-1 as zzk ,sum(jj) as jj  from rd_pss where 
rq  >=  '2021-05-11 00:00:00'
and  rq <= '2021-05-11 23:00:00'
and ( type = 105 or type = 106)
group by market 


[2021-06-16 09:21:54,806][INFO][zmaxx-etl.db-client] 
    select market,sum(kcsl)  as kcsl from rd_product_stock where kcsl > 0 group by market 


[2021-06-16 09:21:54,858][INFO][zmaxx-etl.db-client] 
select  store_key, sum(CAST(sku_qty AS DECIMAL(12,2)) ) as sale_qty_30  from order_item where order_create > DATE_SUB('2021-05-11',INTERVAL 30 DAY)  group by store_key
[2021-06-16 09:21:55,228][INFO][zmaxx-etl.db-client] 
select store_key,COUNT(DISTINCT(customer_key)) as new_u,sum(order_price) as new_u_pay from zmaxx_001.order 
where  customer_key not in
(
select distinct(customer_key) as old_key from zmaxx_001.order   where      order_create  <= '2021-05-11 00:00:00'
)
and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:00:00'
group by store_key 


[2021-06-16 09:21:55,662][INFO][zmaxx-etl.db-client] 
select store_key,count(order_id) as user_null_count from zmaxx_001.order 
where customer_key = 0  and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:00:00'
group by store_key;


[2021-06-16 09:22:18,285][INFO][zmaxx-etl.db-client] 
select  orderI.store_key , 
			   rds.name,   
                          # sum(zorder.order_price) as payment , 
                          # (sum(orderI.sku_pay) - sum(rdp.jj))/sum(orderI.sku_pay) as gross_profit,   
                          # (sum(orderI.sku_pay) - sum(rdp.jj)) as gross,                    
                           sum(orderI.sku_qty) as qty,
                           sum(rdpu.sl) as purchase_sl,
                           #sum(orderI.sku_pay)/sum(orderI.sku_qty) as unit_merchan_price,
                           sum(rdp.jj) as jj,
                           count(distinct(orderI.order_id))  as order_count,
                           #sum(orderI.sku_pay)/count(distinct(orderI.order_id)) as  unit_order_price,
                           sum(orderI.sku_qty)/count(distinct(orderI.order_id))  as  joint_rate,
                           #AVG(zorder.order_pay) as avg_order_pay,
                           #sum(orderI.sku_pay)/sum(orderI.sku_qty)  as unit_goods_price,
                           count(distinct(orderI.sku_id)) as sku_distinct_count,
                           count(distinct(zorder.customer_key)) as user_count
                   from order_item as orderI
                   left join  rd_product as rdp on rdp.id = orderI.sku_id 
                   left join  rd_store as rds on rds.`id` =  orderI.store_key
                   left join  rd_purchase  as rdpu on rdpu.market = orderI.store_key
		   left join  zmaxx_001.order as zorder on zorder.id =   orderI.order_id 	
                   where        orderI.order_source='redian'  
                           and  orderI.sku_pay>0                    
                           and  orderI.create_dt >=  '2021-05-11 00:00:00' 
                           and  orderI.create_dt <= '2021-05-11 23:00:00'
                           #and  p_stock.kcsl > 0
                   group by orderI.store_key ;


[2021-06-16 09:22:19,069][INFO][zmaxx-etl.db-client] 
select market as store_key ,sum(lsjje)*-1 as payment ,sum(zzk)*-1 as zzk ,sum(jj) as jj  from rd_pss where 
rq  >=  '2021-05-11 00:00:00'
and  rq <= '2021-05-11 23:00:00'
and ( type = 105 or type = 106)
group by market 


[2021-06-16 09:22:19,416][INFO][zmaxx-etl.db-client] 
    select market,sum(kcsl)  as kcsl from rd_product_stock where kcsl > 0 group by market 


[2021-06-16 09:22:19,475][INFO][zmaxx-etl.db-client] 
select  store_key, sum(CAST(sku_qty AS DECIMAL(12,2)) ) as sale_qty_30  from order_item where order_create > DATE_SUB('2021-05-11',INTERVAL 30 DAY)  group by store_key
[2021-06-16 09:22:19,829][INFO][zmaxx-etl.db-client] 
select store_key,COUNT(DISTINCT(customer_key)) as new_u,sum(order_price) as new_u_pay from zmaxx_001.order 
where  customer_key not in
(
select distinct(customer_key) as old_key from zmaxx_001.order   where      order_create  <= '2021-05-11 00:00:00'
)
and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:00:00'
group by store_key 


[2021-06-16 09:22:20,254][INFO][zmaxx-etl.db-client] 
select store_key,count(order_id) as user_null_count from zmaxx_001.order 
where customer_key = 0  and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:00:00'
group by store_key;


[2021-06-16 09:25:12,431][INFO][zmaxx-etl.db-client] 
select  orderI.store_key , 
			   rds.name,   
                          # sum(zorder.order_price) as payment , 
                          # (sum(orderI.sku_pay) - sum(rdp.jj))/sum(orderI.sku_pay) as gross_profit,   
                          # (sum(orderI.sku_pay) - sum(rdp.jj)) as gross,                    
                           sum(orderI.sku_qty) as qty,
                           sum(rdpu.sl) as purchase_sl,
                           #sum(orderI.sku_pay)/sum(orderI.sku_qty) as unit_merchan_price,
                           sum(rdp.jj) as jj,
                           count(distinct(orderI.order_id))  as order_count,
                           #sum(orderI.sku_pay)/count(distinct(orderI.order_id)) as  unit_order_price,
                           sum(orderI.sku_qty)/count(distinct(orderI.order_id))  as  joint_rate,
                           #AVG(zorder.order_pay) as avg_order_pay,
                           #sum(orderI.sku_pay)/sum(orderI.sku_qty)  as unit_goods_price,
                           count(distinct(orderI.sku_id)) as sku_distinct_count,
                           count(distinct(zorder.customer_key)) as user_count
                   from order_item as orderI
                   left join  rd_product as rdp on rdp.id = orderI.sku_id 
                   left join  rd_store as rds on rds.`id` =  orderI.store_key
                   left join  rd_purchase  as rdpu on rdpu.market = orderI.store_key
		   left join  zmaxx_001.order as zorder on zorder.id =   orderI.order_id 	
                   where        orderI.order_source='redian'  
                           and  orderI.sku_pay>0                    
                           and  orderI.create_dt >=  '2021-05-11 00:00:00' 
                           and  orderI.create_dt <= '2021-05-11 23:00:00'
                           #and  p_stock.kcsl > 0
                   group by orderI.store_key ;


[2021-06-16 09:25:13,210][INFO][zmaxx-etl.db-client] 
select market as store_key ,sum(lsjje)*-1 as payment ,sum(zzk)*-1 as zzk ,sum(jj) as jj  from rd_pss where 
rq  >=  '2021-05-11 00:00:00'
and  rq <= '2021-05-11 23:00:00'
and ( type = 105 or type = 106)
group by market 


[2021-06-16 09:25:13,516][INFO][zmaxx-etl.db-client] 
    select market,sum(kcsl)  as kcsl from rd_product_stock where kcsl > 0 group by market 


[2021-06-16 09:25:13,564][INFO][zmaxx-etl.db-client] 
select  store_key, sum(CAST(sku_qty AS DECIMAL(12,2)) ) as sale_qty_30  from order_item where order_create > DATE_SUB('2021-05-11',INTERVAL 30 DAY)  group by store_key
[2021-06-16 09:25:13,909][INFO][zmaxx-etl.db-client] 
select store_key,COUNT(DISTINCT(customer_key)) as new_u,sum(order_price) as new_u_pay from zmaxx_001.order 
where  customer_key not in
(
select distinct(customer_key) as old_key from zmaxx_001.order   where      order_create  <= '2021-05-11 00:00:00'
)
and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:00:00'
group by store_key 


[2021-06-16 09:25:14,342][INFO][zmaxx-etl.db-client] 
select store_key,count(order_id) as user_null_count from zmaxx_001.order 
where customer_key = 0  and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:00:00'
group by store_key;


[2021-06-16 09:25:14,346][INFO][zmaxx-etl.db-client] 
select store_key,COUNT(DISTINCT(customer_key)) as old_u,sum(order_pay) as old_u_pay from zmaxx_001.order 
where  customer_key   in
(
select distinct(customer_key) as old_key from zmaxx_001.order   where      order_create  <= '2021-05-11 00:00:00'
)
and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:00:00'
group by store_key 

[2021-06-16 09:28:41,918][INFO][zmaxx-etl.db-client] 
select  orderI.store_key , 
			   rds.name,   
                          # sum(zorder.order_price) as payment , 
                          # (sum(orderI.sku_pay) - sum(rdp.jj))/sum(orderI.sku_pay) as gross_profit,   
                          # (sum(orderI.sku_pay) - sum(rdp.jj)) as gross,                    
                           sum(orderI.sku_qty) as qty,
                          # sum(rdpu.sl) as purchase_sl,
                           #sum(orderI.sku_pay)/sum(orderI.sku_qty) as unit_merchan_price,
                           sum(rdp.jj) as jj,
                           count(distinct(orderI.order_id))  as order_count,
                           #sum(orderI.sku_pay)/count(distinct(orderI.order_id)) as  unit_order_price,
                           sum(orderI.sku_qty)/count(distinct(orderI.order_id))  as  joint_rate,
                           #AVG(zorder.order_pay) as avg_order_pay,
                           #sum(orderI.sku_pay)/sum(orderI.sku_qty)  as unit_goods_price,
                           count(distinct(orderI.sku_id)) as sku_distinct_count,
                           count(distinct(zorder.customer_key)) as user_count
                   from order_item as orderI
                   left join  rd_product as rdp on rdp.id = orderI.sku_id 
                   left join  rd_store as rds on rds.`id` =  orderI.store_key
                   #left join  rd_purchase  as rdpu on rdpu.market = orderI.store_key
		   left join  zmaxx_001.order as zorder on zorder.id =   orderI.order_id 	
                   where        orderI.order_source='redian'  
                           and  orderI.sku_pay>0                    
                           and  orderI.create_dt >=  '2021-05-11 00:00:00' 
                           and  orderI.create_dt <= '2021-05-11 23:00:00'
                           #and  p_stock.kcsl > 0
                   group by orderI.store_key ;


[2021-06-16 09:28:42,354][INFO][zmaxx-etl.db-client] 
select market as store_key ,sum(lsjje)*-1 as payment ,sum(zzk)*-1 as zzk ,sum(jj) as jj  from rd_pss where 
rq  >=  '2021-05-11 00:00:00'
and  rq <= '2021-05-11 23:00:00'
and ( type = 105 or type = 106)
group by market 


[2021-06-16 09:28:42,664][INFO][zmaxx-etl.db-client] 
    select market,sum(kcsl)  as kcsl from rd_product_stock where kcsl > 0 group by market 


[2021-06-16 09:28:42,721][INFO][zmaxx-etl.db-client] 
select  store_key, sum(CAST(sku_qty AS DECIMAL(12,2)) ) as sale_qty_30  from order_item where order_create > DATE_SUB('2021-05-11',INTERVAL 30 DAY)  group by store_key
[2021-06-16 09:28:43,106][INFO][zmaxx-etl.db-client] 
select store_key,COUNT(DISTINCT(customer_key)) as new_u,sum(order_price) as new_u_pay from zmaxx_001.order 
where  customer_key not in
(
select distinct(customer_key) as old_key from zmaxx_001.order   where      order_create  <= '2021-05-11 00:00:00'
)
and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:00:00'
group by store_key 


[2021-06-16 09:28:43,501][INFO][zmaxx-etl.db-client] 
select store_key,count(order_id) as user_null_count from zmaxx_001.order 
where customer_key = 0  and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:00:00'
group by store_key;


[2021-06-16 09:28:43,506][INFO][zmaxx-etl.db-client] 
select store_key,COUNT(DISTINCT(customer_key)) as old_u,sum(order_pay) as old_u_pay from zmaxx_001.order 
where  customer_key   in
(
select distinct(customer_key) as old_key from zmaxx_001.order   where      order_create  <= '2021-05-11 00:00:00'
)
and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:00:00'
group by store_key 

[2021-06-16 09:30:07,974][INFO][zmaxx-etl.db-client] 
select  orderI.store_key , 
			   rds.name,   
                          # sum(zorder.order_price) as payment , 
                          # (sum(orderI.sku_pay) - sum(rdp.jj))/sum(orderI.sku_pay) as gross_profit,   
                          # (sum(orderI.sku_pay) - sum(rdp.jj)) as gross,                    
                           sum(orderI.sku_qty) as qty,
                          # sum(rdpu.sl) as purchase_sl,
                           #sum(orderI.sku_pay)/sum(orderI.sku_qty) as unit_merchan_price,
                           sum(rdp.jj) as jj,
                           count(distinct(orderI.order_id))  as order_count,
                           #sum(orderI.sku_pay)/count(distinct(orderI.order_id)) as  unit_order_price,
                           sum(orderI.sku_qty)/count(distinct(orderI.order_id))  as  joint_rate,
                           #AVG(zorder.order_pay) as avg_order_pay,
                           #sum(orderI.sku_pay)/sum(orderI.sku_qty)  as unit_goods_price,
                           count(distinct(orderI.sku_id)) as sku_distinct_count,
                           count(distinct(zorder.customer_key)) as user_count
                   from order_item as orderI
                   left join  rd_product as rdp on rdp.id = orderI.sku_id 
                   left join  rd_store as rds on rds.`id` =  orderI.store_key
                   #left join  rd_purchase  as rdpu on rdpu.market = orderI.store_key
		   left join  zmaxx_001.order as zorder on zorder.id =   orderI.order_id 	
                   where        orderI.order_source='redian'  
                           and  orderI.sku_pay>0                    
                           and  orderI.create_dt >=  '2021-05-11 00:00:00' 
                           and  orderI.create_dt <= '2021-05-11 23:00:00'
                           #and  p_stock.kcsl > 0
                   group by orderI.store_key ;


[2021-06-16 09:30:08,435][INFO][zmaxx-etl.db-client] 
select market as store_key ,sum(lsjje)*-1 as payment ,sum(zzk)*-1 as zzk ,sum(jj) as jj  from rd_pss where 
rq  >=  '2021-05-11 00:00:00'
and  rq <= '2021-05-11 23:00:00'
and ( type = 105 or type = 106)
group by market 


[2021-06-16 09:30:08,735][INFO][zmaxx-etl.db-client] 
    select market,sum(kcsl)  as kcsl from rd_product_stock where kcsl > 0 group by market 


[2021-06-16 09:30:08,783][INFO][zmaxx-etl.db-client] 
select  store_key, sum(CAST(sku_qty AS DECIMAL(12,2)) ) as sale_qty_30  from order_item where order_create > DATE_SUB('2021-05-11',INTERVAL 30 DAY)  group by store_key
[2021-06-16 09:30:09,141][INFO][zmaxx-etl.db-client] 
select store_key,COUNT(DISTINCT(customer_key)) as new_u,sum(order_price) as new_u_pay from zmaxx_001.order 
where  customer_key not in
(
select distinct(customer_key) as old_key from zmaxx_001.order   where      order_create  <= '2021-05-11 00:00:00'
)
and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:00:00'
group by store_key 


[2021-06-16 09:30:09,546][INFO][zmaxx-etl.db-client] 
select store_key,count(order_id) as user_null_count from zmaxx_001.order 
where customer_key = 0  and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:00:00'
group by store_key;


[2021-06-16 09:30:09,551][INFO][zmaxx-etl.db-client] 
select store_key,COUNT(DISTINCT(customer_key)) as old_u,sum(order_pay) as old_u_pay from zmaxx_001.order 
where  customer_key   in
(
select distinct(customer_key) as old_key from zmaxx_001.order   where      order_create  <= '2021-05-11 00:00:00'
)
and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:00:00'
group by store_key 

[2021-06-16 09:52:56,512][INFO][zmaxx-etl.db-client] 
select  orderI.store_key , 
			   rds.name,   
                          # sum(zorder.order_price) as payment , 
                          # (sum(orderI.sku_pay) - sum(rdp.jj))/sum(orderI.sku_pay) as gross_profit,   
                          # (sum(orderI.sku_pay) - sum(rdp.jj)) as gross,                    
                           sum(orderI.sku_qty) as qty,
                          # sum(rdpu.sl) as purchase_sl,
                           #sum(orderI.sku_pay)/sum(orderI.sku_qty) as unit_merchan_price,
                           sum(rdp.jj) as jj,
                           count(distinct(orderI.order_id))  as order_count,
                           #sum(orderI.sku_pay)/count(distinct(orderI.order_id)) as  unit_order_price,
                           sum(orderI.sku_qty)/count(distinct(orderI.order_id))  as  joint_rate,
                           #AVG(zorder.order_pay) as avg_order_pay,
                           #sum(orderI.sku_pay)/sum(orderI.sku_qty)  as unit_goods_price,
                           count(distinct(orderI.sku_id)) as sku_distinct_count,
                           count(distinct(zorder.customer_key)) as user_count
                   from order_item as orderI
                   left join  rd_product as rdp on rdp.id = orderI.sku_id 
                   left join  rd_store as rds on rds.`id` =  orderI.store_key
                   #left join  rd_purchase  as rdpu on rdpu.market = orderI.store_key
		   left join  zmaxx_001.order as zorder on zorder.id =   orderI.order_id 	
                   where        orderI.order_source='redian'  
                           and  orderI.sku_pay>0                    
                           and  orderI.create_dt >=  '2021-05-11 00:00:00' 
                           and  orderI.create_dt <= '2021-05-11 23:59:59'
                           #and  p_stock.kcsl > 0
                   group by orderI.store_key ;


[2021-06-16 09:52:57,123][INFO][zmaxx-etl.db-client] 
select market as store_key ,sum(lsjje)*-1 as payment ,sum(zzk)*-1 as zzk ,sum(jj) as jj  from rd_pss where 
rq  >=  '2021-05-11 00:00:00'
and  rq <= '2021-05-11 23:59:59'
and ( type = 105 or type = 106)
group by market 


[2021-06-16 09:52:57,626][INFO][zmaxx-etl.db-client] 
    select market,sum(kcsl)  as kcsl from rd_product_stock where kcsl > 0 group by market 


[2021-06-16 09:52:57,685][INFO][zmaxx-etl.db-client] 
select  store_key, sum(CAST(sku_qty AS DECIMAL(12,2)) ) as sale_qty_30  from order_item where order_create > DATE_SUB('2021-05-11',INTERVAL 30 DAY)  group by store_key
[2021-06-16 09:52:58,074][INFO][zmaxx-etl.db-client] 
select store_key,COUNT(DISTINCT(customer_key)) as new_u,sum(order_price) as new_u_pay from zmaxx_001.order 
where  customer_key not in
(
select distinct(customer_key) as old_key from zmaxx_001.order   where      order_create  <= '2021-05-11 00:00:00'
)
and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:59:59'
group by store_key 


[2021-06-16 09:52:58,511][INFO][zmaxx-etl.db-client] 
select store_key,count(order_id) as user_null_count from zmaxx_001.order 
where customer_key = 0  and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:59:59'
group by store_key;


[2021-06-16 09:52:58,516][INFO][zmaxx-etl.db-client] 
select store_key,COUNT(DISTINCT(customer_key)) as old_u,sum(order_pay) as old_u_pay from zmaxx_001.order 
where  customer_key   in
(
select distinct(customer_key) as old_key from zmaxx_001.order   where      order_create  <= '2021-05-11 00:00:00'
)
and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:59:59'
group by store_key 

[2021-06-16 09:52:58,918][INFO][zmaxx-etl.sale] in...insert.....
[2021-06-16 09:52:58,919][INFO][zmaxx-etl.sale] 15
[2021-06-16 09:55:26,096][INFO][zmaxx-etl.db-client] 
select  orderI.store_key , 
			   rds.name,   
                          # sum(zorder.order_price) as payment , 
                          # (sum(orderI.sku_pay) - sum(rdp.jj))/sum(orderI.sku_pay) as gross_profit,   
                          # (sum(orderI.sku_pay) - sum(rdp.jj)) as gross,                    
                           sum(orderI.sku_qty) as qty,
                          # sum(rdpu.sl) as purchase_sl,
                           #sum(orderI.sku_pay)/sum(orderI.sku_qty) as unit_merchan_price,
                           sum(rdp.jj) as jj,
                           count(distinct(orderI.order_id))  as order_count,
                           #sum(orderI.sku_pay)/count(distinct(orderI.order_id)) as  unit_order_price,
                           sum(orderI.sku_qty)/count(distinct(orderI.order_id))  as  joint_rate,
                           #AVG(zorder.order_pay) as avg_order_pay,
                           #sum(orderI.sku_pay)/sum(orderI.sku_qty)  as unit_goods_price,
                           count(distinct(orderI.sku_id)) as sku_distinct_count,
                           count(distinct(zorder.customer_key)) as user_count
                   from order_item as orderI
                   left join  rd_product as rdp on rdp.id = orderI.sku_id 
                   left join  rd_store as rds on rds.`id` =  orderI.store_key
                   #left join  rd_purchase  as rdpu on rdpu.market = orderI.store_key
		   left join  zmaxx_001.order as zorder on zorder.id =   orderI.order_id 	
                   where        orderI.order_source='redian'  
                           and  orderI.sku_pay>0                    
                           and  orderI.create_dt >=  '2021-05-11 00:00:00' 
                           and  orderI.create_dt <= '2021-05-11 23:59:59'
                           #and  p_stock.kcsl > 0
                   group by orderI.store_key ;


[2021-06-16 09:55:26,561][INFO][zmaxx-etl.db-client] 
select market as store_key ,sum(lsjje)*-1 as payment ,sum(zzk)*-1 as zzk ,sum(jj) as jj  from rd_pss where 
rq  >=  '2021-05-11 00:00:00'
and  rq <= '2021-05-11 23:59:59'
and ( type = 105 or type = 106)
group by market 


[2021-06-16 09:55:26,872][INFO][zmaxx-etl.db-client] 
    select market,sum(kcsl)  as kcsl from rd_product_stock where kcsl > 0 group by market 


[2021-06-16 09:55:26,925][INFO][zmaxx-etl.db-client] 
select  store_key, sum(CAST(sku_qty AS DECIMAL(12,2)) ) as sale_qty_30  from order_item where order_create > DATE_SUB('2021-05-11',INTERVAL 30 DAY)  group by store_key
[2021-06-16 09:55:27,339][INFO][zmaxx-etl.db-client] 
select store_key,COUNT(DISTINCT(customer_key)) as new_u,sum(order_price) as new_u_pay from zmaxx_001.order 
where  customer_key not in
(
select distinct(customer_key) as old_key from zmaxx_001.order   where      order_create  <= '2021-05-11 00:00:00'
)
and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:59:59'
group by store_key 


[2021-06-16 09:55:27,773][INFO][zmaxx-etl.db-client] 
select store_key,count(order_id) as user_null_count from zmaxx_001.order 
where customer_key = 0  and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:59:59'
group by store_key;


[2021-06-16 09:55:27,777][INFO][zmaxx-etl.db-client] 
select store_key,COUNT(DISTINCT(customer_key)) as old_u,sum(order_pay) as old_u_pay from zmaxx_001.order 
where  customer_key   in
(
select distinct(customer_key) as old_key from zmaxx_001.order   where      order_create  <= '2021-05-11 00:00:00'
)
and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:59:59'
group by store_key 

[2021-06-16 09:55:28,189][INFO][zmaxx-etl.sale] in...insert.....
[2021-06-16 09:55:28,189][INFO][zmaxx-etl.sale] 15
[2021-06-16 09:55:28,189][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `payment_per_day`,
                                     `gross_rate`, 
                                     `gross`,
                                     `sale_qty`,
                                     `purchase_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `unit_goods_price`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `avg_order_pay`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `per_user_pay`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (10, '上海（诺亚新天地店）', 946.6, 592.25, 194.0, 25619.0, 48.050640825257894, 97, 56, 3.4642857142857144, null, 5,
                                      0.23473484048172405,   10, 0.765265159518276, 0.0, 
                                     '0', 'null');


[2021-06-16 09:55:28,205][ERROR][zmaxx-etl.db-client] Table 'zmaxx_001.rb_sale' doesn't exist
[2021-06-16 09:55:28,205][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `payment_per_day`,
                                     `gross_rate`, 
                                     `gross`,
                                     `sale_qty`,
                                     `purchase_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `unit_goods_price`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `avg_order_pay`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `per_user_pay`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (11, '浙江（杭州工联大厦店）', 3855.3, 2190.53, 674.0, 31726.0, 24.33348673109373, 151, 165, 4.084848484848485, null, 64,
                                      0.5938993074468912,   37, 0.40610069255310877, 0.0, 
                                     '0', 'null');


[2021-06-16 09:55:28,207][ERROR][zmaxx-etl.db-client] Table 'zmaxx_001.rb_sale' doesn't exist
[2021-06-16 09:55:28,207][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `payment_per_day`,
                                     `gross_rate`, 
                                     `gross`,
                                     `sale_qty`,
                                     `purchase_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `unit_goods_price`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `avg_order_pay`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `per_user_pay`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (12, '浙江（杭州古墩印象城店）', 2018.2, 1297.27, 160.0, 26201.0, 116.84703433922998, 76, 39, 4.102564102564102, null, 3,
                                      0.1948270736299673,   2, 0.8051729263700327, 0.8717949, 
                                     '34', 'null');


[2021-06-16 09:55:28,210][ERROR][zmaxx-etl.db-client] Table 'zmaxx_001.rb_sale' doesn't exist
[2021-06-16 09:55:28,210][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `payment_per_day`,
                                     `gross_rate`, 
                                     `gross`,
                                     `sale_qty`,
                                     `purchase_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `unit_goods_price`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `avg_order_pay`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `per_user_pay`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (13, '浙江（杭州绿地店）', 729.7, 395.26, 106.0, 28707.0, 106.17802983602515, 64, 27, 3.925925925925926, null, 3,
                                      0.2602439358640537,   5, 0.7397560641359463, 0.44444445, 
                                     '12', 'null');


[2021-06-16 09:55:28,212][ERROR][zmaxx-etl.db-client] Table 'zmaxx_001.rb_sale' doesn't exist
[2021-06-16 09:55:28,212][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `payment_per_day`,
                                     `gross_rate`, 
                                     `gross`,
                                     `sale_qty`,
                                     `purchase_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `unit_goods_price`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `avg_order_pay`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `per_user_pay`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (14, '浙江（杭州in77店）', 2391.0, 1404.46, 446.0, 28819.0, 24.919870871043983, 140, 104, 4.288461538461538, null, 0,
                                      0.0,   8, 1.0, 0.9326923, 
                                     '97', 'null');


[2021-06-16 09:55:28,214][ERROR][zmaxx-etl.db-client] Table 'zmaxx_001.rb_sale' doesn't exist
[2021-06-16 09:55:28,214][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `payment_per_day`,
                                     `gross_rate`, 
                                     `gross`,
                                     `sale_qty`,
                                     `purchase_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `unit_goods_price`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `avg_order_pay`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `per_user_pay`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (17, '江苏（泰州姜堰店）', 383.8, 666.3, 6.0, 4433.0, 361.3858695652174, 6, 5, 1.2, null, 0,
                                      0.0,   3, 1.0, 0.4, 
                                     '2', 'null');


[2021-06-16 09:55:28,216][ERROR][zmaxx-etl.db-client] Table 'zmaxx_001.rb_sale' doesn't exist
[2021-06-16 09:55:28,217][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `payment_per_day`,
                                     `gross_rate`, 
                                     `gross`,
                                     `sale_qty`,
                                     `purchase_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `unit_goods_price`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `avg_order_pay`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `per_user_pay`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (18, '浙江（慈溪保利店）', 1733.4, 1391.58, 16.0, 7712.0, 126.63382594417078, 16, 10, 1.6, null, 0,
                                      0.0,   1, 1.0, 1.0, 
                                     '10', 'null');


[2021-06-16 09:55:28,218][ERROR][zmaxx-etl.db-client] Table 'zmaxx_001.rb_sale' doesn't exist
[2021-06-16 09:55:28,218][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `payment_per_day`,
                                     `gross_rate`, 
                                     `gross`,
                                     `sale_qty`,
                                     `purchase_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `unit_goods_price`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `avg_order_pay`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `per_user_pay`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (19, '安徽（蚌埠金鹏广场店）', 4703.0, 7136.78, 54.0, 5728.0, 91.9914346895075, 51, 20, 2.7, null, 5,
                                      0.6152881139698064,   11, 0.3847118860301936, 0.25, 
                                     '5', 'null');


[2021-06-16 09:55:28,220][ERROR][zmaxx-etl.db-client] Table 'zmaxx_001.rb_sale' doesn't exist
[2021-06-16 09:55:28,220][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `payment_per_day`,
                                     `gross_rate`, 
                                     `gross`,
                                     `sale_qty`,
                                     `purchase_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `unit_goods_price`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `avg_order_pay`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `per_user_pay`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (21, '江苏（淮安玖珑汇店）', 811.8, 688.01, 11.0, 7697.0, 172.32089552238807, 10, 8, 1.375, null, 0,
                                      0.0,   1, 1.0, 1.0, 
                                     '8', 'null');


[2021-06-16 09:55:28,222][ERROR][zmaxx-etl.db-client] Table 'zmaxx_001.rb_sale' doesn't exist
[2021-06-16 09:55:28,222][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `payment_per_day`,
                                     `gross_rate`, 
                                     `gross`,
                                     `sale_qty`,
                                     `purchase_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `unit_goods_price`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `avg_order_pay`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `per_user_pay`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (26, '上海（北上海广场店）', 3489.0, 3006.9, 112.0, 26236.0, 80.759285860866, 82, 38, 2.9473684210526314, null, 0,
                                      0.0,   1, 1.0, 0.0, 
                                     '0', 'null');


[2021-06-16 09:55:28,223][ERROR][zmaxx-etl.db-client] Table 'zmaxx_001.rb_sale' doesn't exist
[2021-06-16 09:55:28,224][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `payment_per_day`,
                                     `gross_rate`, 
                                     `gross`,
                                     `sale_qty`,
                                     `purchase_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `unit_goods_price`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `avg_order_pay`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `per_user_pay`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (27, '浙江（杭州新天地店）', 767.3, 442.61, 160.0, 27173.0, 67.56091496767777, 70, 33, 4.848484848484849, null, 0,
                                      0.0,   1, 1.0, 0.0, 
                                     '0', 'null');


[2021-06-16 09:55:28,225][ERROR][zmaxx-etl.db-client] Table 'zmaxx_001.rb_sale' doesn't exist
[2021-06-16 09:55:28,225][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `payment_per_day`,
                                     `gross_rate`, 
                                     `gross`,
                                     `sale_qty`,
                                     `purchase_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `unit_goods_price`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `avg_order_pay`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `per_user_pay`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (32, '江苏（南京新街口店）', 10361.4, 6653.47, 2276.0, 26447.0, 16.489182617370158, 229, 539, 4.222634508348794, null, 2,
                                      0.03082595016117513,   2, 0.9691740498388248, 1.0037106, 
                                     '541', 'null');


[2021-06-16 09:55:28,227][ERROR][zmaxx-etl.db-client] Table 'zmaxx_001.rb_sale' doesn't exist
[2021-06-16 09:55:28,227][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `payment_per_day`,
                                     `gross_rate`, 
                                     `gross`,
                                     `sale_qty`,
                                     `purchase_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `unit_goods_price`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `avg_order_pay`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `per_user_pay`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (4, '上海（七宝凯德店）', 2639.0, 1605.06, 297.0, 26829.0, 35.09658570618759, 160, 97, 3.0618556701030926, null, 1,
                                      0.10485032209170139,   4, 0.8951496779082986, 0.9587629, 
                                     '93', 'null');


[2021-06-16 09:55:28,229][ERROR][zmaxx-etl.db-client] Table 'zmaxx_001.rb_sale' doesn't exist
[2021-06-16 09:55:28,229][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `payment_per_day`,
                                     `gross_rate`, 
                                     `gross`,
                                     `sale_qty`,
                                     `purchase_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `unit_goods_price`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `avg_order_pay`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `per_user_pay`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (5, '上海（宝山新业坊店）', 413.1, 230.23, 84.0, 11293.0, 33.01081555100848, 48, 25, 3.36, null, 1,
                                      0.1055434519486807,   4, 0.8944565480513194, 0.84, 
                                     '21', 'null');


[2021-06-16 09:55:28,231][ERROR][zmaxx-etl.db-client] Table 'zmaxx_001.rb_sale' doesn't exist
[2021-06-16 09:55:28,231][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `payment_per_day`,
                                     `gross_rate`, 
                                     `gross`,
                                     `sale_qty`,
                                     `purchase_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `unit_goods_price`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `avg_order_pay`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `per_user_pay`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (6, '上海（桃浦新邻天地店）', 1142.2, 766.06, 178.0, 27843.0, 58.62507018528916, 85, 52, 3.423076923076923, null, 0,
                                      0.0,   4, 1.0, 0.9423077, 
                                     '49', 'null');


[2021-06-16 09:55:28,233][ERROR][zmaxx-etl.db-client] Table 'zmaxx_001.rb_sale' doesn't exist
[2021-06-16 09:56:40,518][INFO][zmaxx-etl.db-client] 
select  orderI.store_key , 
			   rds.name,   
                          # sum(zorder.order_price) as payment , 
                          # (sum(orderI.sku_pay) - sum(rdp.jj))/sum(orderI.sku_pay) as gross_profit,   
                          # (sum(orderI.sku_pay) - sum(rdp.jj)) as gross,                    
                           sum(orderI.sku_qty) as qty,
                          # sum(rdpu.sl) as purchase_sl,
                           #sum(orderI.sku_pay)/sum(orderI.sku_qty) as unit_merchan_price,
                           sum(rdp.jj) as jj,
                           count(distinct(orderI.order_id))  as order_count,
                           #sum(orderI.sku_pay)/count(distinct(orderI.order_id)) as  unit_order_price,
                           sum(orderI.sku_qty)/count(distinct(orderI.order_id))  as  joint_rate,
                           #AVG(zorder.order_pay) as avg_order_pay,
                           #sum(orderI.sku_pay)/sum(orderI.sku_qty)  as unit_goods_price,
                           count(distinct(orderI.sku_id)) as sku_distinct_count,
                           count(distinct(zorder.customer_key)) as user_count
                   from order_item as orderI
                   left join  rd_product as rdp on rdp.id = orderI.sku_id 
                   left join  rd_store as rds on rds.`id` =  orderI.store_key
                   #left join  rd_purchase  as rdpu on rdpu.market = orderI.store_key
		   left join  zmaxx_001.order as zorder on zorder.id =   orderI.order_id 	
                   where        orderI.order_source='redian'  
                           and  orderI.sku_pay>0                    
                           and  orderI.create_dt >=  '2021-05-11 00:00:00' 
                           and  orderI.create_dt <= '2021-05-11 23:59:59'
                           #and  p_stock.kcsl > 0
                   group by orderI.store_key ;


[2021-06-16 09:56:41,003][INFO][zmaxx-etl.db-client] 
select market as store_key ,sum(lsjje)*-1 as payment ,sum(zzk)*-1 as zzk ,sum(jj) as jj  from rd_pss where 
rq  >=  '2021-05-11 00:00:00'
and  rq <= '2021-05-11 23:59:59'
and ( type = 105 or type = 106)
group by market 


[2021-06-16 09:56:41,338][INFO][zmaxx-etl.db-client] 
    select market,sum(kcsl)  as kcsl from rd_product_stock where kcsl > 0 group by market 


[2021-06-16 09:56:41,392][INFO][zmaxx-etl.db-client] 
select  store_key, sum(CAST(sku_qty AS DECIMAL(12,2)) ) as sale_qty_30  from order_item where order_create > DATE_SUB('2021-05-11',INTERVAL 30 DAY)  group by store_key
[2021-06-16 09:56:41,796][INFO][zmaxx-etl.db-client] 
select store_key,COUNT(DISTINCT(customer_key)) as new_u,sum(order_price) as new_u_pay from zmaxx_001.order 
where  customer_key not in
(
select distinct(customer_key) as old_key from zmaxx_001.order   where      order_create  <= '2021-05-11 00:00:00'
)
and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:59:59'
group by store_key 


[2021-06-16 09:56:42,224][INFO][zmaxx-etl.db-client] 
select store_key,count(order_id) as user_null_count from zmaxx_001.order 
where customer_key = 0  and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:59:59'
group by store_key;


[2021-06-16 09:56:42,229][INFO][zmaxx-etl.db-client] 
select store_key,COUNT(DISTINCT(customer_key)) as old_u,sum(order_pay) as old_u_pay from zmaxx_001.order 
where  customer_key   in
(
select distinct(customer_key) as old_key from zmaxx_001.order   where      order_create  <= '2021-05-11 00:00:00'
)
and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:59:59'
group by store_key 

[2021-06-16 09:56:42,659][INFO][zmaxx-etl.sale] in...insert.....
[2021-06-16 09:56:42,659][INFO][zmaxx-etl.sale] 15
[2021-06-16 09:56:42,660][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `payment_per_day`,
                                     `gross_rate`, 
                                     `gross`,
                                     `sale_qty`,
                                     `purchase_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `unit_goods_price`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `avg_order_pay`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `per_user_pay`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (10, '上海（诺亚新天地店）', 946.6, 592.25, 194.0, 25619.0, 48.050640825257894, 97, 56, 3.4642857142857144, null, 5,
                                      0.23473484048172405,   10, 0.765265159518276, 0.0, 
                                     '0', 'null');


[2021-06-16 09:56:42,666][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 09:56:42,666][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `payment_per_day`,
                                     `gross_rate`, 
                                     `gross`,
                                     `sale_qty`,
                                     `purchase_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `unit_goods_price`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `avg_order_pay`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `per_user_pay`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (11, '浙江（杭州工联大厦店）', 3855.3, 2190.53, 674.0, 31726.0, 24.33348673109373, 151, 165, 4.084848484848485, null, 64,
                                      0.5938993074468912,   37, 0.40610069255310877, 0.0, 
                                     '0', 'null');


[2021-06-16 09:56:42,668][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 09:56:42,669][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `payment_per_day`,
                                     `gross_rate`, 
                                     `gross`,
                                     `sale_qty`,
                                     `purchase_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `unit_goods_price`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `avg_order_pay`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `per_user_pay`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (12, '浙江（杭州古墩印象城店）', 2018.2, 1297.27, 160.0, 26201.0, 116.84703433922998, 76, 39, 4.102564102564102, null, 3,
                                      0.1948270736299673,   2, 0.8051729263700327, 0.8717949, 
                                     '34', 'null');


[2021-06-16 09:56:42,670][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 09:56:42,670][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `payment_per_day`,
                                     `gross_rate`, 
                                     `gross`,
                                     `sale_qty`,
                                     `purchase_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `unit_goods_price`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `avg_order_pay`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `per_user_pay`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (13, '浙江（杭州绿地店）', 729.7, 395.26, 106.0, 28707.0, 106.17802983602515, 64, 27, 3.925925925925926, null, 3,
                                      0.2602439358640537,   5, 0.7397560641359463, 0.44444445, 
                                     '12', 'null');


[2021-06-16 09:56:42,672][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 09:56:42,672][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `payment_per_day`,
                                     `gross_rate`, 
                                     `gross`,
                                     `sale_qty`,
                                     `purchase_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `unit_goods_price`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `avg_order_pay`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `per_user_pay`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (14, '浙江（杭州in77店）', 2391.0, 1404.46, 446.0, 28819.0, 24.919870871043983, 140, 104, 4.288461538461538, null, 0,
                                      0.0,   8, 1.0, 0.9326923, 
                                     '97', 'null');


[2021-06-16 09:56:42,674][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 09:56:42,674][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `payment_per_day`,
                                     `gross_rate`, 
                                     `gross`,
                                     `sale_qty`,
                                     `purchase_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `unit_goods_price`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `avg_order_pay`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `per_user_pay`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (17, '江苏（泰州姜堰店）', 383.8, 666.3, 6.0, 4433.0, 361.3858695652174, 6, 5, 1.2, null, 0,
                                      0.0,   3, 1.0, 0.4, 
                                     '2', 'null');


[2021-06-16 09:56:42,676][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 09:56:42,676][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `payment_per_day`,
                                     `gross_rate`, 
                                     `gross`,
                                     `sale_qty`,
                                     `purchase_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `unit_goods_price`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `avg_order_pay`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `per_user_pay`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (18, '浙江（慈溪保利店）', 1733.4, 1391.58, 16.0, 7712.0, 126.63382594417078, 16, 10, 1.6, null, 0,
                                      0.0,   1, 1.0, 1.0, 
                                     '10', 'null');


[2021-06-16 09:56:42,678][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 09:56:42,678][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `payment_per_day`,
                                     `gross_rate`, 
                                     `gross`,
                                     `sale_qty`,
                                     `purchase_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `unit_goods_price`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `avg_order_pay`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `per_user_pay`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (19, '安徽（蚌埠金鹏广场店）', 4703.0, 7136.78, 54.0, 5728.0, 91.9914346895075, 51, 20, 2.7, null, 5,
                                      0.6152881139698064,   11, 0.3847118860301936, 0.25, 
                                     '5', 'null');


[2021-06-16 09:56:42,681][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 09:56:42,681][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `payment_per_day`,
                                     `gross_rate`, 
                                     `gross`,
                                     `sale_qty`,
                                     `purchase_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `unit_goods_price`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `avg_order_pay`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `per_user_pay`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (21, '江苏（淮安玖珑汇店）', 811.8, 688.01, 11.0, 7697.0, 172.32089552238807, 10, 8, 1.375, null, 0,
                                      0.0,   1, 1.0, 1.0, 
                                     '8', 'null');


[2021-06-16 09:56:42,683][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 09:56:42,683][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `payment_per_day`,
                                     `gross_rate`, 
                                     `gross`,
                                     `sale_qty`,
                                     `purchase_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `unit_goods_price`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `avg_order_pay`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `per_user_pay`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (26, '上海（北上海广场店）', 3489.0, 3006.9, 112.0, 26236.0, 80.759285860866, 82, 38, 2.9473684210526314, null, 0,
                                      0.0,   1, 1.0, 0.0, 
                                     '0', 'null');


[2021-06-16 09:56:42,688][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 09:56:42,688][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `payment_per_day`,
                                     `gross_rate`, 
                                     `gross`,
                                     `sale_qty`,
                                     `purchase_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `unit_goods_price`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `avg_order_pay`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `per_user_pay`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (27, '浙江（杭州新天地店）', 767.3, 442.61, 160.0, 27173.0, 67.56091496767777, 70, 33, 4.848484848484849, null, 0,
                                      0.0,   1, 1.0, 0.0, 
                                     '0', 'null');


[2021-06-16 09:56:42,690][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 09:56:42,690][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `payment_per_day`,
                                     `gross_rate`, 
                                     `gross`,
                                     `sale_qty`,
                                     `purchase_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `unit_goods_price`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `avg_order_pay`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `per_user_pay`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (32, '江苏（南京新街口店）', 10361.4, 6653.47, 2276.0, 26447.0, 16.489182617370158, 229, 539, 4.222634508348794, null, 2,
                                      0.03082595016117513,   2, 0.9691740498388248, 1.0037106, 
                                     '541', 'null');


[2021-06-16 09:56:42,693][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 09:56:42,693][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `payment_per_day`,
                                     `gross_rate`, 
                                     `gross`,
                                     `sale_qty`,
                                     `purchase_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `unit_goods_price`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `avg_order_pay`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `per_user_pay`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (4, '上海（七宝凯德店）', 2639.0, 1605.06, 297.0, 26829.0, 35.09658570618759, 160, 97, 3.0618556701030926, null, 1,
                                      0.10485032209170139,   4, 0.8951496779082986, 0.9587629, 
                                     '93', 'null');


[2021-06-16 09:56:42,696][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 09:56:42,696][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `payment_per_day`,
                                     `gross_rate`, 
                                     `gross`,
                                     `sale_qty`,
                                     `purchase_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `unit_goods_price`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `avg_order_pay`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `per_user_pay`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (5, '上海（宝山新业坊店）', 413.1, 230.23, 84.0, 11293.0, 33.01081555100848, 48, 25, 3.36, null, 1,
                                      0.1055434519486807,   4, 0.8944565480513194, 0.84, 
                                     '21', 'null');


[2021-06-16 09:56:42,698][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 09:56:42,698][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `payment_per_day`,
                                     `gross_rate`, 
                                     `gross`,
                                     `sale_qty`,
                                     `purchase_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `unit_goods_price`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `avg_order_pay`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `per_user_pay`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (6, '上海（桃浦新邻天地店）', 1142.2, 766.06, 178.0, 27843.0, 58.62507018528916, 85, 52, 3.423076923076923, null, 0,
                                      0.0,   4, 1.0, 0.9423077, 
                                     '49', 'null');


[2021-06-16 09:56:42,701][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:02:21,614][INFO][zmaxx-etl.db-client] 
select  orderI.store_key , 
			   rds.name,   
                          # sum(zorder.order_price) as payment , 
                          # (sum(orderI.sku_pay) - sum(rdp.jj))/sum(orderI.sku_pay) as gross_profit,   
                          # (sum(orderI.sku_pay) - sum(rdp.jj)) as gross,                    
                           sum(orderI.sku_qty) as qty,
                          # sum(rdpu.sl) as purchase_sl,
                           #sum(orderI.sku_pay)/sum(orderI.sku_qty) as unit_merchan_price,
                           sum(rdp.jj) as jj,
                           count(distinct(orderI.order_id))  as order_count,
                           #sum(orderI.sku_pay)/count(distinct(orderI.order_id)) as  unit_order_price,
                           sum(orderI.sku_qty)/count(distinct(orderI.order_id))  as  joint_rate,
                           #AVG(zorder.order_pay) as avg_order_pay,
                           #sum(orderI.sku_pay)/sum(orderI.sku_qty)  as unit_goods_price,
                           count(distinct(orderI.sku_id)) as sku_distinct_count,
                           count(distinct(zorder.customer_key)) as user_count
                   from order_item as orderI
                   left join  rd_product as rdp on rdp.id = orderI.sku_id 
                   left join  rd_store as rds on rds.`id` =  orderI.store_key
                   #left join  rd_purchase  as rdpu on rdpu.market = orderI.store_key
		   left join  zmaxx_001.order as zorder on zorder.id =   orderI.order_id 	
                   where        orderI.order_source='redian'  
                           and  orderI.sku_pay>0                    
                           and  orderI.create_dt >=  '2021-05-11 00:00:00' 
                           and  orderI.create_dt <= '2021-05-11 23:59:59'
                           #and  p_stock.kcsl > 0
                   group by orderI.store_key ;


[2021-06-16 10:02:22,090][INFO][zmaxx-etl.db-client] 
select market as store_key ,sum(lsjje)*-1 as payment ,sum(zzk)*-1 as zzk ,sum(jj) as jj  from rd_pss where 
rq  >=  '2021-05-11 00:00:00'
and  rq <= '2021-05-11 23:59:59'
and ( type = 105 or type = 106)
group by market 


[2021-06-16 10:02:22,402][INFO][zmaxx-etl.db-client] 
    select market,sum(kcsl)  as kcsl from rd_product_stock where kcsl > 0 group by market 


[2021-06-16 10:02:22,454][INFO][zmaxx-etl.db-client] 
select  store_key, sum(CAST(sku_qty AS DECIMAL(12,2)) ) as sale_qty_30  from order_item where order_create > DATE_SUB('2021-05-11',INTERVAL 30 DAY)  group by store_key
[2021-06-16 10:02:22,835][INFO][zmaxx-etl.db-client] 
select store_key,COUNT(DISTINCT(customer_key)) as new_u,sum(order_price) as new_u_pay from zmaxx_001.order 
where  customer_key not in
(
select distinct(customer_key) as old_key from zmaxx_001.order   where      order_create  <= '2021-05-11 00:00:00'
)
and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:59:59'
group by store_key 


[2021-06-16 10:02:23,258][INFO][zmaxx-etl.db-client] 
select store_key,count(order_id) as user_null_count from zmaxx_001.order 
where customer_key = 0  and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:59:59'
group by store_key;


[2021-06-16 10:02:23,262][INFO][zmaxx-etl.db-client] 
select store_key,COUNT(DISTINCT(customer_key)) as old_u,sum(order_pay) as old_u_pay from zmaxx_001.order 
where  customer_key   in
(
select distinct(customer_key) as old_key from zmaxx_001.order   where      order_create  <= '2021-05-11 00:00:00'
)
and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:59:59'
group by store_key 

[2021-06-16 10:02:23,668][INFO][zmaxx-etl.sale] in...insert.....
[2021-06-16 10:02:23,669][INFO][zmaxx-etl.sale] 15
[2021-06-16 10:02:23,669][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `payment_per_day`,
                                     `gross_rate`, 
                                     `gross`,
                                     `sale_qty`,
                                     `purchase_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `unit_goods_price`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `avg_order_pay`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `per_user_pay`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (10, '上海（诺亚新天地店）', 946.6, 592.25, 194.0, 25619.0, 48.050640825257894, 97, 56, 3.4642857142857144, null, 5,
                                      0.23473484048172405,   10, 0.765265159518276, 0.0, 
                                     '0', '2021-05-11');


[2021-06-16 10:02:23,677][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:02:23,677][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `payment_per_day`,
                                     `gross_rate`, 
                                     `gross`,
                                     `sale_qty`,
                                     `purchase_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `unit_goods_price`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `avg_order_pay`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `per_user_pay`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (11, '浙江（杭州工联大厦店）', 3855.3, 2190.53, 674.0, 31726.0, 24.33348673109373, 151, 165, 4.084848484848485, null, 64,
                                      0.5938993074468912,   37, 0.40610069255310877, 0.0, 
                                     '0', '2021-05-11');


[2021-06-16 10:02:23,680][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:02:23,680][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `payment_per_day`,
                                     `gross_rate`, 
                                     `gross`,
                                     `sale_qty`,
                                     `purchase_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `unit_goods_price`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `avg_order_pay`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `per_user_pay`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (12, '浙江（杭州古墩印象城店）', 2018.2, 1297.27, 160.0, 26201.0, 116.84703433922998, 76, 39, 4.102564102564102, null, 3,
                                      0.1948270736299673,   2, 0.8051729263700327, 0.8717949, 
                                     '34', '2021-05-11');


[2021-06-16 10:02:23,682][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:02:23,682][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `payment_per_day`,
                                     `gross_rate`, 
                                     `gross`,
                                     `sale_qty`,
                                     `purchase_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `unit_goods_price`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `avg_order_pay`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `per_user_pay`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (13, '浙江（杭州绿地店）', 729.7, 395.26, 106.0, 28707.0, 106.17802983602515, 64, 27, 3.925925925925926, null, 3,
                                      0.2602439358640537,   5, 0.7397560641359463, 0.44444445, 
                                     '12', '2021-05-11');


[2021-06-16 10:02:23,683][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:02:23,684][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `payment_per_day`,
                                     `gross_rate`, 
                                     `gross`,
                                     `sale_qty`,
                                     `purchase_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `unit_goods_price`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `avg_order_pay`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `per_user_pay`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (14, '浙江（杭州in77店）', 2391.0, 1404.46, 446.0, 28819.0, 24.919870871043983, 140, 104, 4.288461538461538, null, 0,
                                      0.0,   8, 1.0, 0.9326923, 
                                     '97', '2021-05-11');


[2021-06-16 10:02:23,686][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:02:23,686][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `payment_per_day`,
                                     `gross_rate`, 
                                     `gross`,
                                     `sale_qty`,
                                     `purchase_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `unit_goods_price`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `avg_order_pay`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `per_user_pay`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (17, '江苏（泰州姜堰店）', 383.8, 666.3, 6.0, 4433.0, 361.3858695652174, 6, 5, 1.2, null, 0,
                                      0.0,   3, 1.0, 0.4, 
                                     '2', '2021-05-11');


[2021-06-16 10:02:23,688][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:02:23,688][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `payment_per_day`,
                                     `gross_rate`, 
                                     `gross`,
                                     `sale_qty`,
                                     `purchase_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `unit_goods_price`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `avg_order_pay`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `per_user_pay`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (18, '浙江（慈溪保利店）', 1733.4, 1391.58, 16.0, 7712.0, 126.63382594417078, 16, 10, 1.6, null, 0,
                                      0.0,   1, 1.0, 1.0, 
                                     '10', '2021-05-11');


[2021-06-16 10:02:23,690][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:02:23,690][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `payment_per_day`,
                                     `gross_rate`, 
                                     `gross`,
                                     `sale_qty`,
                                     `purchase_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `unit_goods_price`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `avg_order_pay`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `per_user_pay`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (19, '安徽（蚌埠金鹏广场店）', 4703.0, 7136.78, 54.0, 5728.0, 91.9914346895075, 51, 20, 2.7, null, 5,
                                      0.6152881139698064,   11, 0.3847118860301936, 0.25, 
                                     '5', '2021-05-11');


[2021-06-16 10:02:23,692][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:02:23,692][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `payment_per_day`,
                                     `gross_rate`, 
                                     `gross`,
                                     `sale_qty`,
                                     `purchase_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `unit_goods_price`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `avg_order_pay`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `per_user_pay`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (21, '江苏（淮安玖珑汇店）', 811.8, 688.01, 11.0, 7697.0, 172.32089552238807, 10, 8, 1.375, null, 0,
                                      0.0,   1, 1.0, 1.0, 
                                     '8', '2021-05-11');


[2021-06-16 10:02:23,694][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:02:23,694][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `payment_per_day`,
                                     `gross_rate`, 
                                     `gross`,
                                     `sale_qty`,
                                     `purchase_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `unit_goods_price`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `avg_order_pay`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `per_user_pay`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (26, '上海（北上海广场店）', 3489.0, 3006.9, 112.0, 26236.0, 80.759285860866, 82, 38, 2.9473684210526314, null, 0,
                                      0.0,   1, 1.0, 0.0, 
                                     '0', '2021-05-11');


[2021-06-16 10:02:23,695][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:02:23,695][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `payment_per_day`,
                                     `gross_rate`, 
                                     `gross`,
                                     `sale_qty`,
                                     `purchase_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `unit_goods_price`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `avg_order_pay`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `per_user_pay`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (27, '浙江（杭州新天地店）', 767.3, 442.61, 160.0, 27173.0, 67.56091496767777, 70, 33, 4.848484848484849, null, 0,
                                      0.0,   1, 1.0, 0.0, 
                                     '0', '2021-05-11');


[2021-06-16 10:02:23,697][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:02:23,697][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `payment_per_day`,
                                     `gross_rate`, 
                                     `gross`,
                                     `sale_qty`,
                                     `purchase_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `unit_goods_price`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `avg_order_pay`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `per_user_pay`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (32, '江苏（南京新街口店）', 10361.4, 6653.47, 2276.0, 26447.0, 16.489182617370158, 229, 539, 4.222634508348794, null, 2,
                                      0.03082595016117513,   2, 0.9691740498388248, 1.0037106, 
                                     '541', '2021-05-11');


[2021-06-16 10:02:23,698][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:02:23,699][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `payment_per_day`,
                                     `gross_rate`, 
                                     `gross`,
                                     `sale_qty`,
                                     `purchase_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `unit_goods_price`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `avg_order_pay`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `per_user_pay`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (4, '上海（七宝凯德店）', 2639.0, 1605.06, 297.0, 26829.0, 35.09658570618759, 160, 97, 3.0618556701030926, null, 1,
                                      0.10485032209170139,   4, 0.8951496779082986, 0.9587629, 
                                     '93', '2021-05-11');


[2021-06-16 10:02:23,700][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:02:23,700][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `payment_per_day`,
                                     `gross_rate`, 
                                     `gross`,
                                     `sale_qty`,
                                     `purchase_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `unit_goods_price`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `avg_order_pay`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `per_user_pay`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (5, '上海（宝山新业坊店）', 413.1, 230.23, 84.0, 11293.0, 33.01081555100848, 48, 25, 3.36, null, 1,
                                      0.1055434519486807,   4, 0.8944565480513194, 0.84, 
                                     '21', '2021-05-11');


[2021-06-16 10:02:23,702][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:02:23,702][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `payment_per_day`,
                                     `gross_rate`, 
                                     `gross`,
                                     `sale_qty`,
                                     `purchase_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `unit_goods_price`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `avg_order_pay`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `per_user_pay`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (6, '上海（桃浦新邻天地店）', 1142.2, 766.06, 178.0, 27843.0, 58.62507018528916, 85, 52, 3.423076923076923, null, 0,
                                      0.0,   4, 1.0, 0.9423077, 
                                     '49', '2021-05-11');


[2021-06-16 10:02:23,704][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:04:32,652][INFO][zmaxx-etl.db-client] 
select  orderI.store_key , 
			   rds.name,   
                          # sum(zorder.order_price) as payment , 
                          # (sum(orderI.sku_pay) - sum(rdp.jj))/sum(orderI.sku_pay) as gross_profit,   
                          # (sum(orderI.sku_pay) - sum(rdp.jj)) as gross,                    
                           sum(orderI.sku_qty) as qty,
                          # sum(rdpu.sl) as purchase_sl,
                           #sum(orderI.sku_pay)/sum(orderI.sku_qty) as unit_merchan_price,
                           sum(rdp.jj) as jj,
                           count(distinct(orderI.order_id))  as order_count,
                           #sum(orderI.sku_pay)/count(distinct(orderI.order_id)) as  unit_order_price,
                           sum(orderI.sku_qty)/count(distinct(orderI.order_id))  as  joint_rate,
                           #AVG(zorder.order_pay) as avg_order_pay,
                           #sum(orderI.sku_pay)/sum(orderI.sku_qty)  as unit_goods_price,
                           count(distinct(orderI.sku_id)) as sku_distinct_count,
                           count(distinct(zorder.customer_key)) as user_count
                   from order_item as orderI
                   left join  rd_product as rdp on rdp.id = orderI.sku_id 
                   left join  rd_store as rds on rds.`id` =  orderI.store_key
                   #left join  rd_purchase  as rdpu on rdpu.market = orderI.store_key
		   left join  zmaxx_001.order as zorder on zorder.id =   orderI.order_id 	
                   where        orderI.order_source='redian'  
                           and  orderI.sku_pay>0                    
                           and  orderI.create_dt >=  '2021-05-11 00:00:00' 
                           and  orderI.create_dt <= '2021-05-11 23:59:59'
                           #and  p_stock.kcsl > 0
                   group by orderI.store_key ;


[2021-06-16 10:04:33,152][INFO][zmaxx-etl.db-client] 
select market as store_key ,sum(lsjje)*-1 as payment ,sum(zzk)*-1 as zzk ,sum(jj) as jj  from rd_pss where 
rq  >=  '2021-05-11 00:00:00'
and  rq <= '2021-05-11 23:59:59'
and ( type = 105 or type = 106)
group by market 


[2021-06-16 10:04:33,458][INFO][zmaxx-etl.db-client] 
    select market,sum(kcsl)  as kcsl from rd_product_stock where kcsl > 0 group by market 


[2021-06-16 10:04:33,506][INFO][zmaxx-etl.db-client] 
select  store_key, sum(CAST(sku_qty AS DECIMAL(12,2)) ) as sale_qty_30  from order_item where order_create > DATE_SUB('2021-05-11',INTERVAL 30 DAY)  group by store_key
[2021-06-16 10:04:33,881][INFO][zmaxx-etl.db-client] 
select store_key,COUNT(DISTINCT(customer_key)) as new_u,sum(order_price) as new_u_pay from zmaxx_001.order 
where  customer_key not in
(
select distinct(customer_key) as old_key from zmaxx_001.order   where      order_create  <= '2021-05-11 00:00:00'
)
and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:59:59'
group by store_key 


[2021-06-16 10:04:34,328][INFO][zmaxx-etl.db-client] 
select store_key,count(order_id) as user_null_count from zmaxx_001.order 
where customer_key = 0  and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:59:59'
group by store_key;


[2021-06-16 10:04:34,332][INFO][zmaxx-etl.db-client] 
select store_key,COUNT(DISTINCT(customer_key)) as old_u,sum(order_pay) as old_u_pay from zmaxx_001.order 
where  customer_key   in
(
select distinct(customer_key) as old_key from zmaxx_001.order   where      order_create  <= '2021-05-11 00:00:00'
)
and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:59:59'
group by store_key 

[2021-06-16 10:04:34,735][INFO][zmaxx-etl.sale] in...insert.....
[2021-06-16 10:04:34,736][INFO][zmaxx-etl.sale] 15
[2021-06-16 10:04:34,736][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (10, '上海（诺亚新天地店）', 946.6, 592.25, 194.0, 25619.0, 48.050640825257894, 97, 56, 3.4642857142857144, null, 5,
                                      0.23473484048172405,   10, 0.765265159518276, 0.0, 
                                     '0', '2021-05-11');


[2021-06-16 10:04:34,738][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:04:34,738][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (11, '浙江（杭州工联大厦店）', 3855.3, 2190.53, 674.0, 31726.0, 24.33348673109373, 151, 165, 4.084848484848485, null, 64,
                                      0.5938993074468912,   37, 0.40610069255310877, 0.0, 
                                     '0', '2021-05-11');


[2021-06-16 10:04:34,740][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:04:34,740][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (12, '浙江（杭州古墩印象城店）', 2018.2, 1297.27, 160.0, 26201.0, 116.84703433922998, 76, 39, 4.102564102564102, null, 3,
                                      0.1948270736299673,   2, 0.8051729263700327, 0.8717949, 
                                     '34', '2021-05-11');


[2021-06-16 10:04:34,742][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:04:34,742][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (13, '浙江（杭州绿地店）', 729.7, 395.26, 106.0, 28707.0, 106.17802983602515, 64, 27, 3.925925925925926, null, 3,
                                      0.2602439358640537,   5, 0.7397560641359463, 0.44444445, 
                                     '12', '2021-05-11');


[2021-06-16 10:04:34,743][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:04:34,743][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (14, '浙江（杭州in77店）', 2391.0, 1404.46, 446.0, 28819.0, 24.919870871043983, 140, 104, 4.288461538461538, null, 0,
                                      0.0,   8, 1.0, 0.9326923, 
                                     '97', '2021-05-11');


[2021-06-16 10:04:34,745][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:04:34,745][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (17, '江苏（泰州姜堰店）', 383.8, 666.3, 6.0, 4433.0, 361.3858695652174, 6, 5, 1.2, null, 0,
                                      0.0,   3, 1.0, 0.4, 
                                     '2', '2021-05-11');


[2021-06-16 10:04:34,746][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:04:34,746][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (18, '浙江（慈溪保利店）', 1733.4, 1391.58, 16.0, 7712.0, 126.63382594417078, 16, 10, 1.6, null, 0,
                                      0.0,   1, 1.0, 1.0, 
                                     '10', '2021-05-11');


[2021-06-16 10:04:34,747][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:04:34,748][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (19, '安徽（蚌埠金鹏广场店）', 4703.0, 7136.78, 54.0, 5728.0, 91.9914346895075, 51, 20, 2.7, null, 5,
                                      0.6152881139698064,   11, 0.3847118860301936, 0.25, 
                                     '5', '2021-05-11');


[2021-06-16 10:04:34,749][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:04:34,749][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (21, '江苏（淮安玖珑汇店）', 811.8, 688.01, 11.0, 7697.0, 172.32089552238807, 10, 8, 1.375, null, 0,
                                      0.0,   1, 1.0, 1.0, 
                                     '8', '2021-05-11');


[2021-06-16 10:04:34,750][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:04:34,750][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (26, '上海（北上海广场店）', 3489.0, 3006.9, 112.0, 26236.0, 80.759285860866, 82, 38, 2.9473684210526314, null, 0,
                                      0.0,   1, 1.0, 0.0, 
                                     '0', '2021-05-11');


[2021-06-16 10:04:34,752][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:04:34,752][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (27, '浙江（杭州新天地店）', 767.3, 442.61, 160.0, 27173.0, 67.56091496767777, 70, 33, 4.848484848484849, null, 0,
                                      0.0,   1, 1.0, 0.0, 
                                     '0', '2021-05-11');


[2021-06-16 10:04:34,753][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:04:34,753][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (32, '江苏（南京新街口店）', 10361.4, 6653.47, 2276.0, 26447.0, 16.489182617370158, 229, 539, 4.222634508348794, null, 2,
                                      0.03082595016117513,   2, 0.9691740498388248, 1.0037106, 
                                     '541', '2021-05-11');


[2021-06-16 10:04:34,754][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:04:34,754][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (4, '上海（七宝凯德店）', 2639.0, 1605.06, 297.0, 26829.0, 35.09658570618759, 160, 97, 3.0618556701030926, null, 1,
                                      0.10485032209170139,   4, 0.8951496779082986, 0.9587629, 
                                     '93', '2021-05-11');


[2021-06-16 10:04:34,756][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:04:34,756][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (5, '上海（宝山新业坊店）', 413.1, 230.23, 84.0, 11293.0, 33.01081555100848, 48, 25, 3.36, null, 1,
                                      0.1055434519486807,   4, 0.8944565480513194, 0.84, 
                                     '21', '2021-05-11');


[2021-06-16 10:04:34,757][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:04:34,757][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (6, '上海（桃浦新邻天地店）', 1142.2, 766.06, 178.0, 27843.0, 58.62507018528916, 85, 52, 3.423076923076923, null, 0,
                                      0.0,   4, 1.0, 0.9423077, 
                                     '49', '2021-05-11');


[2021-06-16 10:04:34,758][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:05:31,629][INFO][zmaxx-etl.db-client] 
select  orderI.store_key , 
			   rds.name,   
                          # sum(zorder.order_price) as payment , 
                          # (sum(orderI.sku_pay) - sum(rdp.jj))/sum(orderI.sku_pay) as gross_profit,   
                          # (sum(orderI.sku_pay) - sum(rdp.jj)) as gross,                    
                           sum(orderI.sku_qty) as qty,
                          # sum(rdpu.sl) as purchase_sl,
                           #sum(orderI.sku_pay)/sum(orderI.sku_qty) as unit_merchan_price,
                           sum(rdp.jj) as jj,
                           count(distinct(orderI.order_id))  as order_count,
                           #sum(orderI.sku_pay)/count(distinct(orderI.order_id)) as  unit_order_price,
                           sum(orderI.sku_qty)/count(distinct(orderI.order_id))  as  joint_rate,
                           #AVG(zorder.order_pay) as avg_order_pay,
                           #sum(orderI.sku_pay)/sum(orderI.sku_qty)  as unit_goods_price,
                           count(distinct(orderI.sku_id)) as sku_distinct_count,
                           count(distinct(zorder.customer_key)) as user_count
                   from order_item as orderI
                   left join  rd_product as rdp on rdp.id = orderI.sku_id 
                   left join  rd_store as rds on rds.`id` =  orderI.store_key
                   #left join  rd_purchase  as rdpu on rdpu.market = orderI.store_key
		   left join  zmaxx_001.order as zorder on zorder.id =   orderI.order_id 	
                   where        orderI.order_source='redian'  
                           and  orderI.sku_pay>0                    
                           and  orderI.create_dt >=  '2021-05-11 00:00:00' 
                           and  orderI.create_dt <= '2021-05-11 23:59:59'
                           #and  p_stock.kcsl > 0
                   group by orderI.store_key ;


[2021-06-16 10:05:32,128][INFO][zmaxx-etl.db-client] 
select market as store_key ,sum(lsjje)*-1 as payment ,sum(zzk)*-1 as zzk ,sum(jj) as jj  from rd_pss where 
rq  >=  '2021-05-11 00:00:00'
and  rq <= '2021-05-11 23:59:59'
and ( type = 105 or type = 106)
group by market 


[2021-06-16 10:05:32,437][INFO][zmaxx-etl.db-client] 
    select market,sum(kcsl)  as kcsl from rd_product_stock where kcsl > 0 group by market 


[2021-06-16 10:05:32,488][INFO][zmaxx-etl.db-client] 
select  store_key, sum(CAST(sku_qty AS DECIMAL(12,2)) ) as sale_qty_30  from order_item where order_create > DATE_SUB('2021-05-11',INTERVAL 30 DAY)  group by store_key
[2021-06-16 10:05:32,898][INFO][zmaxx-etl.db-client] 
select store_key,COUNT(DISTINCT(customer_key)) as new_u,sum(order_price) as new_u_pay from zmaxx_001.order 
where  customer_key not in
(
select distinct(customer_key) as old_key from zmaxx_001.order   where      order_create  <= '2021-05-11 00:00:00'
)
and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:59:59'
group by store_key 


[2021-06-16 10:05:33,337][INFO][zmaxx-etl.db-client] 
select store_key,count(order_id) as user_null_count from zmaxx_001.order 
where customer_key = 0  and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:59:59'
group by store_key;


[2021-06-16 10:05:33,340][INFO][zmaxx-etl.db-client] 
select store_key,COUNT(DISTINCT(customer_key)) as old_u,sum(order_pay) as old_u_pay from zmaxx_001.order 
where  customer_key   in
(
select distinct(customer_key) as old_key from zmaxx_001.order   where      order_create  <= '2021-05-11 00:00:00'
)
and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:59:59'
group by store_key 

[2021-06-16 10:05:33,756][INFO][zmaxx-etl.sale] in...insert.....
[2021-06-16 10:05:33,757][INFO][zmaxx-etl.sale] 15
[2021-06-16 10:05:33,757][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (10, '上海（诺亚新天地店）', 946.6, 592.25, 194.0, 25619.0, 48.050640825257894, 97, 56, 3.4642857142857144, null, 5,
                                      0.23473484048172405,   10, 0.765265159518276, 0.0, 
                                     '0', '2021-05-11');


[2021-06-16 10:05:33,759][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:05:33,759][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (11, '浙江（杭州工联大厦店）', 3855.3, 2190.53, 674.0, 31726.0, 24.33348673109373, 151, 165, 4.084848484848485, null, 64,
                                      0.5938993074468912,   37, 0.40610069255310877, 0.0, 
                                     '0', '2021-05-11');


[2021-06-16 10:05:33,761][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:05:33,761][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (12, '浙江（杭州古墩印象城店）', 2018.2, 1297.27, 160.0, 26201.0, 116.84703433922998, 76, 39, 4.102564102564102, null, 3,
                                      0.1948270736299673,   2, 0.8051729263700327, 0.8717949, 
                                     '34', '2021-05-11');


[2021-06-16 10:05:33,763][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:05:33,763][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (13, '浙江（杭州绿地店）', 729.7, 395.26, 106.0, 28707.0, 106.17802983602515, 64, 27, 3.925925925925926, null, 3,
                                      0.2602439358640537,   5, 0.7397560641359463, 0.44444445, 
                                     '12', '2021-05-11');


[2021-06-16 10:05:33,767][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:05:33,767][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (14, '浙江（杭州in77店）', 2391.0, 1404.46, 446.0, 28819.0, 24.919870871043983, 140, 104, 4.288461538461538, null, 0,
                                      0.0,   8, 1.0, 0.9326923, 
                                     '97', '2021-05-11');


[2021-06-16 10:05:33,770][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:05:33,771][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (17, '江苏（泰州姜堰店）', 383.8, 666.3, 6.0, 4433.0, 361.3858695652174, 6, 5, 1.2, null, 0,
                                      0.0,   3, 1.0, 0.4, 
                                     '2', '2021-05-11');


[2021-06-16 10:05:33,772][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:05:33,772][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (18, '浙江（慈溪保利店）', 1733.4, 1391.58, 16.0, 7712.0, 126.63382594417078, 16, 10, 1.6, null, 0,
                                      0.0,   1, 1.0, 1.0, 
                                     '10', '2021-05-11');


[2021-06-16 10:05:33,774][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:05:33,774][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (19, '安徽（蚌埠金鹏广场店）', 4703.0, 7136.78, 54.0, 5728.0, 91.9914346895075, 51, 20, 2.7, null, 5,
                                      0.6152881139698064,   11, 0.3847118860301936, 0.25, 
                                     '5', '2021-05-11');


[2021-06-16 10:05:33,776][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:05:33,776][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (21, '江苏（淮安玖珑汇店）', 811.8, 688.01, 11.0, 7697.0, 172.32089552238807, 10, 8, 1.375, null, 0,
                                      0.0,   1, 1.0, 1.0, 
                                     '8', '2021-05-11');


[2021-06-16 10:05:33,781][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:05:33,781][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (26, '上海（北上海广场店）', 3489.0, 3006.9, 112.0, 26236.0, 80.759285860866, 82, 38, 2.9473684210526314, null, 0,
                                      0.0,   1, 1.0, 0.0, 
                                     '0', '2021-05-11');


[2021-06-16 10:05:33,785][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:05:33,785][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (27, '浙江（杭州新天地店）', 767.3, 442.61, 160.0, 27173.0, 67.56091496767777, 70, 33, 4.848484848484849, null, 0,
                                      0.0,   1, 1.0, 0.0, 
                                     '0', '2021-05-11');


[2021-06-16 10:05:33,789][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:05:33,789][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (32, '江苏（南京新街口店）', 10361.4, 6653.47, 2276.0, 26447.0, 16.489182617370158, 229, 539, 4.222634508348794, null, 2,
                                      0.03082595016117513,   2, 0.9691740498388248, 1.0037106, 
                                     '541', '2021-05-11');


[2021-06-16 10:05:33,793][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:05:33,793][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (4, '上海（七宝凯德店）', 2639.0, 1605.06, 297.0, 26829.0, 35.09658570618759, 160, 97, 3.0618556701030926, null, 1,
                                      0.10485032209170139,   4, 0.8951496779082986, 0.9587629, 
                                     '93', '2021-05-11');


[2021-06-16 10:05:33,803][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:05:33,811][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (5, '上海（宝山新业坊店）', 413.1, 230.23, 84.0, 11293.0, 33.01081555100848, 48, 25, 3.36, null, 1,
                                      0.1055434519486807,   4, 0.8944565480513194, 0.84, 
                                     '21', '2021-05-11');


[2021-06-16 10:05:33,817][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:05:33,823][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (6, '上海（桃浦新邻天地店）', 1142.2, 766.06, 178.0, 27843.0, 58.62507018528916, 85, 52, 3.423076923076923, null, 0,
                                      0.0,   4, 1.0, 0.9423077, 
                                     '49', '2021-05-11');


[2021-06-16 10:05:33,839][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:06:35,041][INFO][zmaxx-etl.db-client] 
select  orderI.store_key , 
			   rds.name,   
                          # sum(zorder.order_price) as payment , 
                          # (sum(orderI.sku_pay) - sum(rdp.jj))/sum(orderI.sku_pay) as gross_profit,   
                          # (sum(orderI.sku_pay) - sum(rdp.jj)) as gross,                    
                           sum(orderI.sku_qty) as qty,
                          # sum(rdpu.sl) as purchase_sl,
                           #sum(orderI.sku_pay)/sum(orderI.sku_qty) as unit_merchan_price,
                           sum(rdp.jj) as jj,
                           count(distinct(orderI.order_id))  as order_count,
                           #sum(orderI.sku_pay)/count(distinct(orderI.order_id)) as  unit_order_price,
                           sum(orderI.sku_qty)/count(distinct(orderI.order_id))  as  joint_rate,
                           #AVG(zorder.order_pay) as avg_order_pay,
                           #sum(orderI.sku_pay)/sum(orderI.sku_qty)  as unit_goods_price,
                           count(distinct(orderI.sku_id)) as sku_distinct_count,
                           count(distinct(zorder.customer_key)) as user_count
                   from order_item as orderI
                   left join  rd_product as rdp on rdp.id = orderI.sku_id 
                   left join  rd_store as rds on rds.`id` =  orderI.store_key
                   #left join  rd_purchase  as rdpu on rdpu.market = orderI.store_key
		   left join  zmaxx_001.order as zorder on zorder.id =   orderI.order_id 	
                   where        orderI.order_source='redian'  
                           and  orderI.sku_pay>0                    
                           and  orderI.create_dt >=  '2021-05-11 00:00:00' 
                           and  orderI.create_dt <= '2021-05-11 23:59:59'
                           #and  p_stock.kcsl > 0
                   group by orderI.store_key ;


[2021-06-16 10:06:35,507][INFO][zmaxx-etl.db-client] 
select market as store_key ,sum(lsjje)*-1 as payment ,sum(zzk)*-1 as zzk ,sum(jj) as jj  from rd_pss where 
rq  >=  '2021-05-11 00:00:00'
and  rq <= '2021-05-11 23:59:59'
and ( type = 105 or type = 106)
group by market 


[2021-06-16 10:06:35,835][INFO][zmaxx-etl.db-client] 
    select market,sum(kcsl)  as kcsl from rd_product_stock where kcsl > 0 group by market 


[2021-06-16 10:06:35,892][INFO][zmaxx-etl.db-client] 
select  store_key, sum(CAST(sku_qty AS DECIMAL(12,2)) ) as sale_qty_30  from order_item where order_create > DATE_SUB('2021-05-11',INTERVAL 30 DAY)  group by store_key
[2021-06-16 10:06:36,283][INFO][zmaxx-etl.db-client] 
select store_key,COUNT(DISTINCT(customer_key)) as new_u,sum(order_price) as new_u_pay from zmaxx_001.order 
where  customer_key not in
(
select distinct(customer_key) as old_key from zmaxx_001.order   where      order_create  <= '2021-05-11 00:00:00'
)
and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:59:59'
group by store_key 


[2021-06-16 10:06:36,710][INFO][zmaxx-etl.db-client] 
select store_key,count(order_id) as user_null_count from zmaxx_001.order 
where customer_key = 0  and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:59:59'
group by store_key;


[2021-06-16 10:06:36,714][INFO][zmaxx-etl.db-client] 
select store_key,COUNT(DISTINCT(customer_key)) as old_u,sum(order_pay) as old_u_pay from zmaxx_001.order 
where  customer_key   in
(
select distinct(customer_key) as old_key from zmaxx_001.order   where      order_create  <= '2021-05-11 00:00:00'
)
and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:59:59'
group by store_key 

[2021-06-16 10:06:37,146][INFO][zmaxx-etl.sale] in...insert.....
[2021-06-16 10:06:37,159][INFO][zmaxx-etl.sale] ({joint_rate 3.4642857142857144, jj 592.25, order_count 56, store_name 上海（诺亚新天地店）, user_count 15, store_key 10, sku_distinct_count 97, new_user_count 5, calculate_end_date 2021-05-11, stock_turnover_days 48.050640825257894, calculate_begin_date 2021-05-11, old_user_rate 0.765265159518276, kcsl 25619.0, userless_order_rate 0.0, sale_qty 194.0, old_user_count 10, userless_order_count 0, new_user_rate 0.23473484048172405, payment 946.6} {joint_rate 4.084848484848485, jj 2190.53, order_count 165, store_name 浙江（杭州工联大厦店）, user_count 101, store_key 11, sku_distinct_count 151, new_user_count 64, calculate_end_date 2021-05-11, stock_turnover_days 24.33348673109373, calculate_begin_date 2021-05-11, old_user_rate 0.40610069255310877, kcsl 31726.0, userless_order_rate 0.0, sale_qty 674.0, old_user_count 37, userless_order_count 0, new_user_rate 0.5938993074468912, payment 3855.3} {joint_rate 4.102564102564102, jj 1297.27, order_count 39, store_name 浙江（杭州古墩印象城店）, user_count 5, store_key 12, sku_distinct_count 76, new_user_count 3, calculate_end_date 2021-05-11, stock_turnover_days 116.84703433922998, calculate_begin_date 2021-05-11, old_user_rate 0.8051729263700327, kcsl 26201.0, userless_order_rate 0.8717949, sale_qty 160.0, old_user_count 2, userless_order_count 34, new_user_rate 0.1948270736299673, payment 2018.2} {joint_rate 3.925925925925926, jj 395.26, order_count 27, store_name 浙江（杭州绿地店）, user_count 8, store_key 13, sku_distinct_count 64, new_user_count 3, calculate_end_date 2021-05-11, stock_turnover_days 106.17802983602515, calculate_begin_date 2021-05-11, old_user_rate 0.7397560641359463, kcsl 28707.0, userless_order_rate 0.44444445, sale_qty 106.0, old_user_count 5, userless_order_count 12, new_user_rate 0.2602439358640537, payment 729.7} {joint_rate 4.288461538461538, jj 1404.46, order_count 104, store_name 浙江（杭州in77店）, user_count 8, store_key 14, sku_distinct_count 140, new_user_count 0, calculate_end_date 2021-05-11, stock_turnover_days 24.919870871043983, calculate_begin_date 2021-05-11, old_user_rate 1.0, kcsl 28819.0, userless_order_rate 0.9326923, sale_qty 446.0, old_user_count 8, userless_order_count 97, new_user_rate 0.0, payment 2391.0} {joint_rate 1.2, jj 666.3, order_count 5, store_name 江苏（泰州姜堰店）, user_count 3, store_key 17, sku_distinct_count 6, new_user_count 0, calculate_end_date 2021-05-11, stock_turnover_days 361.3858695652174, calculate_begin_date 2021-05-11, old_user_rate 1.0, kcsl 4433.0, userless_order_rate 0.4, sale_qty 6.0, old_user_count 3, userless_order_count 2, new_user_rate 0.0, payment 383.8} {joint_rate 1.6, jj 1391.58, order_count 10, store_name 浙江（慈溪保利店）, user_count 1, store_key 18, sku_distinct_count 16, new_user_count 0, calculate_end_date 2021-05-11, stock_turnover_days 126.63382594417078, calculate_begin_date 2021-05-11, old_user_rate 1.0, kcsl 7712.0, userless_order_rate 1.0, sale_qty 16.0, old_user_count 1, userless_order_count 10, new_user_rate 0.0, payment 1733.4} {joint_rate 2.7, jj 7136.78, order_count 20, store_name 安徽（蚌埠金鹏广场店）, user_count 16, store_key 19, sku_distinct_count 51, new_user_count 5, calculate_end_date 2021-05-11, stock_turnover_days 91.9914346895075, calculate_begin_date 2021-05-11, old_user_rate 0.3847118860301936, kcsl 5728.0, userless_order_rate 0.25, sale_qty 54.0, old_user_count 11, userless_order_count 5, new_user_rate 0.6152881139698064, payment 4703.0} {joint_rate 1.375, jj 688.01, order_count 8, store_name 江苏（淮安玖珑汇店）, user_count 1, store_key 21, sku_distinct_count 10, new_user_count 0, calculate_end_date 2021-05-11, stock_turnover_days 172.32089552238807, calculate_begin_date 2021-05-11, old_user_rate 1.0, kcsl 7697.0, userless_order_rate 1.0, sale_qty 11.0, old_user_count 1, userless_order_count 8, new_user_rate 0.0, payment 811.8} {joint_rate 2.9473684210526314, jj 3006.9, order_count 38, store_name 上海（北上海广场店）, user_count 1, store_key 26, sku_distinct_count 82, new_user_count 0, calculate_end_date 2021-05-11, stock_turnover_days 80.759285860866, calculate_begin_date 2021-05-11, old_user_rate 1.0, kcsl 26236.0, userless_order_rate 0.0, sale_qty 112.0, old_user_count 1, userless_order_count 0, new_user_rate 0.0, payment 3489.0} {joint_rate 4.848484848484849, jj 442.61, order_count 33, store_name 浙江（杭州新天地店）, user_count 1, store_key 27, sku_distinct_count 70, new_user_count 0, calculate_end_date 2021-05-11, stock_turnover_days 67.56091496767777, calculate_begin_date 2021-05-11, old_user_rate 1.0, kcsl 27173.0, userless_order_rate 0.0, sale_qty 160.0, old_user_count 1, userless_order_count 0, new_user_rate 0.0, payment 767.3} {joint_rate 4.222634508348794, jj 6653.47, order_count 539, store_name 江苏（南京新街口店）, user_count 4, store_key 32, sku_distinct_count 229, new_user_count 2, calculate_end_date 2021-05-11, stock_turnover_days 16.489182617370158, calculate_begin_date 2021-05-11, old_user_rate 0.9691740498388248, kcsl 26447.0, userless_order_rate 1.0037106, sale_qty 2276.0, old_user_count 2, userless_order_count 541, new_user_rate 0.03082595016117513, payment 10361.4} {joint_rate 3.0618556701030926, jj 1605.06, order_count 97, store_name 上海（七宝凯德店）, user_count 5, store_key 4, sku_distinct_count 160, new_user_count 1, calculate_end_date 2021-05-11, stock_turnover_days 35.09658570618759, calculate_begin_date 2021-05-11, old_user_rate 0.8951496779082986, kcsl 26829.0, userless_order_rate 0.9587629, sale_qty 297.0, old_user_count 4, userless_order_count 93, new_user_rate 0.10485032209170139, payment 2639.0} {joint_rate 3.36, jj 230.23, order_count 25, store_name 上海（宝山新业坊店）, user_count 5, store_key 5, sku_distinct_count 48, new_user_count 1, calculate_end_date 2021-05-11, stock_turnover_days 33.01081555100848, calculate_begin_date 2021-05-11, old_user_rate 0.8944565480513194, kcsl 11293.0, userless_order_rate 0.84, sale_qty 84.0, old_user_count 4, userless_order_count 21, new_user_rate 0.1055434519486807, payment 413.1} {joint_rate 3.423076923076923, jj 766.06, order_count 52, store_name 上海（桃浦新邻天地店）, user_count 4, store_key 6, sku_distinct_count 85, new_user_count 0, calculate_end_date 2021-05-11, stock_turnover_days 58.62507018528916, calculate_begin_date 2021-05-11, old_user_rate 1.0, kcsl 27843.0, userless_order_rate 0.9423077, sale_qty 178.0, old_user_count 4, userless_order_count 49, new_user_rate 0.0, payment 1142.2})
[2021-06-16 10:06:37,159][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (10, '上海（诺亚新天地店）', 946.6, 592.25, 194.0, 25619.0, 48.050640825257894, 97, 56, 3.4642857142857144, null, 5,
                                      0.23473484048172405,   10, 0.765265159518276, 0.0, 
                                     '0', '2021-05-11');


[2021-06-16 10:06:37,161][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:06:37,161][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (11, '浙江（杭州工联大厦店）', 3855.3, 2190.53, 674.0, 31726.0, 24.33348673109373, 151, 165, 4.084848484848485, null, 64,
                                      0.5938993074468912,   37, 0.40610069255310877, 0.0, 
                                     '0', '2021-05-11');


[2021-06-16 10:06:37,163][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:06:37,163][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (12, '浙江（杭州古墩印象城店）', 2018.2, 1297.27, 160.0, 26201.0, 116.84703433922998, 76, 39, 4.102564102564102, null, 3,
                                      0.1948270736299673,   2, 0.8051729263700327, 0.8717949, 
                                     '34', '2021-05-11');


[2021-06-16 10:06:37,165][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:06:37,165][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (13, '浙江（杭州绿地店）', 729.7, 395.26, 106.0, 28707.0, 106.17802983602515, 64, 27, 3.925925925925926, null, 3,
                                      0.2602439358640537,   5, 0.7397560641359463, 0.44444445, 
                                     '12', '2021-05-11');


[2021-06-16 10:06:37,166][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:06:37,167][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (14, '浙江（杭州in77店）', 2391.0, 1404.46, 446.0, 28819.0, 24.919870871043983, 140, 104, 4.288461538461538, null, 0,
                                      0.0,   8, 1.0, 0.9326923, 
                                     '97', '2021-05-11');


[2021-06-16 10:06:37,169][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:06:37,169][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (17, '江苏（泰州姜堰店）', 383.8, 666.3, 6.0, 4433.0, 361.3858695652174, 6, 5, 1.2, null, 0,
                                      0.0,   3, 1.0, 0.4, 
                                     '2', '2021-05-11');


[2021-06-16 10:06:37,171][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:06:37,171][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (18, '浙江（慈溪保利店）', 1733.4, 1391.58, 16.0, 7712.0, 126.63382594417078, 16, 10, 1.6, null, 0,
                                      0.0,   1, 1.0, 1.0, 
                                     '10', '2021-05-11');


[2021-06-16 10:06:37,173][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:06:37,173][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (19, '安徽（蚌埠金鹏广场店）', 4703.0, 7136.78, 54.0, 5728.0, 91.9914346895075, 51, 20, 2.7, null, 5,
                                      0.6152881139698064,   11, 0.3847118860301936, 0.25, 
                                     '5', '2021-05-11');


[2021-06-16 10:06:37,175][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:06:37,175][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (21, '江苏（淮安玖珑汇店）', 811.8, 688.01, 11.0, 7697.0, 172.32089552238807, 10, 8, 1.375, null, 0,
                                      0.0,   1, 1.0, 1.0, 
                                     '8', '2021-05-11');


[2021-06-16 10:06:37,179][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:06:37,180][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (26, '上海（北上海广场店）', 3489.0, 3006.9, 112.0, 26236.0, 80.759285860866, 82, 38, 2.9473684210526314, null, 0,
                                      0.0,   1, 1.0, 0.0, 
                                     '0', '2021-05-11');


[2021-06-16 10:06:37,182][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:06:37,182][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (27, '浙江（杭州新天地店）', 767.3, 442.61, 160.0, 27173.0, 67.56091496767777, 70, 33, 4.848484848484849, null, 0,
                                      0.0,   1, 1.0, 0.0, 
                                     '0', '2021-05-11');


[2021-06-16 10:06:37,183][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:06:37,184][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (32, '江苏（南京新街口店）', 10361.4, 6653.47, 2276.0, 26447.0, 16.489182617370158, 229, 539, 4.222634508348794, null, 2,
                                      0.03082595016117513,   2, 0.9691740498388248, 1.0037106, 
                                     '541', '2021-05-11');


[2021-06-16 10:06:37,185][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:06:37,185][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (4, '上海（七宝凯德店）', 2639.0, 1605.06, 297.0, 26829.0, 35.09658570618759, 160, 97, 3.0618556701030926, null, 1,
                                      0.10485032209170139,   4, 0.8951496779082986, 0.9587629, 
                                     '93', '2021-05-11');


[2021-06-16 10:06:37,187][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:06:37,187][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (5, '上海（宝山新业坊店）', 413.1, 230.23, 84.0, 11293.0, 33.01081555100848, 48, 25, 3.36, null, 1,
                                      0.1055434519486807,   4, 0.8944565480513194, 0.84, 
                                     '21', '2021-05-11');


[2021-06-16 10:06:37,189][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:06:37,189][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (6, '上海（桃浦新邻天地店）', 1142.2, 766.06, 178.0, 27843.0, 58.62507018528916, 85, 52, 3.423076923076923, null, 0,
                                      0.0,   4, 1.0, 0.9423077, 
                                     '49', '2021-05-11');


[2021-06-16 10:06:37,191][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:07:08,967][INFO][zmaxx-etl.db-client] 
select  orderI.store_key , 
			   rds.name,   
                          # sum(zorder.order_price) as payment , 
                          # (sum(orderI.sku_pay) - sum(rdp.jj))/sum(orderI.sku_pay) as gross_profit,   
                          # (sum(orderI.sku_pay) - sum(rdp.jj)) as gross,                    
                           sum(orderI.sku_qty) as qty,
                          # sum(rdpu.sl) as purchase_sl,
                           #sum(orderI.sku_pay)/sum(orderI.sku_qty) as unit_merchan_price,
                           sum(rdp.jj) as jj,
                           count(distinct(orderI.order_id))  as order_count,
                           #sum(orderI.sku_pay)/count(distinct(orderI.order_id)) as  unit_order_price,
                           sum(orderI.sku_qty)/count(distinct(orderI.order_id))  as  joint_rate,
                           #AVG(zorder.order_pay) as avg_order_pay,
                           #sum(orderI.sku_pay)/sum(orderI.sku_qty)  as unit_goods_price,
                           count(distinct(orderI.sku_id)) as sku_distinct_count,
                           count(distinct(zorder.customer_key)) as user_count
                   from order_item as orderI
                   left join  rd_product as rdp on rdp.id = orderI.sku_id 
                   left join  rd_store as rds on rds.`id` =  orderI.store_key
                   #left join  rd_purchase  as rdpu on rdpu.market = orderI.store_key
		   left join  zmaxx_001.order as zorder on zorder.id =   orderI.order_id 	
                   where        orderI.order_source='redian'  
                           and  orderI.sku_pay>0                    
                           and  orderI.create_dt >=  '2021-05-11 00:00:00' 
                           and  orderI.create_dt <= '2021-05-11 23:00:00'
                           #and  p_stock.kcsl > 0
                   group by orderI.store_key ;


[2021-06-16 10:07:09,436][INFO][zmaxx-etl.db-client] 
select market as store_key ,sum(lsjje)*-1 as payment ,sum(zzk)*-1 as zzk ,sum(jj) as jj  from rd_pss where 
rq  >=  '2021-05-11 00:00:00'
and  rq <= '2021-05-11 23:00:00'
and ( type = 105 or type = 106)
group by market 


[2021-06-16 10:07:09,743][INFO][zmaxx-etl.db-client] 
    select market,sum(kcsl)  as kcsl from rd_product_stock where kcsl > 0 group by market 


[2021-06-16 10:07:09,794][INFO][zmaxx-etl.db-client] 
select  store_key, sum(CAST(sku_qty AS DECIMAL(12,2)) ) as sale_qty_30  from order_item where order_create > DATE_SUB('2021-05-11',INTERVAL 30 DAY)  group by store_key
[2021-06-16 10:07:10,173][INFO][zmaxx-etl.db-client] 
select store_key,COUNT(DISTINCT(customer_key)) as new_u,sum(order_price) as new_u_pay from zmaxx_001.order 
where  customer_key not in
(
select distinct(customer_key) as old_key from zmaxx_001.order   where      order_create  <= '2021-05-11 00:00:00'
)
and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:00:00'
group by store_key 


[2021-06-16 10:07:10,625][INFO][zmaxx-etl.db-client] 
select store_key,count(order_id) as user_null_count from zmaxx_001.order 
where customer_key = 0  and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:00:00'
group by store_key;


[2021-06-16 10:07:10,629][INFO][zmaxx-etl.db-client] 
select store_key,COUNT(DISTINCT(customer_key)) as old_u,sum(order_pay) as old_u_pay from zmaxx_001.order 
where  customer_key   in
(
select distinct(customer_key) as old_key from zmaxx_001.order   where      order_create  <= '2021-05-11 00:00:00'
)
and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:00:00'
group by store_key 

[2021-06-16 10:07:41,130][INFO][zmaxx-etl.db-client] 
select  orderI.store_key , 
			   rds.name,   
                          # sum(zorder.order_price) as payment , 
                          # (sum(orderI.sku_pay) - sum(rdp.jj))/sum(orderI.sku_pay) as gross_profit,   
                          # (sum(orderI.sku_pay) - sum(rdp.jj)) as gross,                    
                           sum(orderI.sku_qty) as qty,
                          # sum(rdpu.sl) as purchase_sl,
                           #sum(orderI.sku_pay)/sum(orderI.sku_qty) as unit_merchan_price,
                           sum(rdp.jj) as jj,
                           count(distinct(orderI.order_id))  as order_count,
                           #sum(orderI.sku_pay)/count(distinct(orderI.order_id)) as  unit_order_price,
                           sum(orderI.sku_qty)/count(distinct(orderI.order_id))  as  joint_rate,
                           #AVG(zorder.order_pay) as avg_order_pay,
                           #sum(orderI.sku_pay)/sum(orderI.sku_qty)  as unit_goods_price,
                           count(distinct(orderI.sku_id)) as sku_distinct_count,
                           count(distinct(zorder.customer_key)) as user_count
                   from order_item as orderI
                   left join  rd_product as rdp on rdp.id = orderI.sku_id 
                   left join  rd_store as rds on rds.`id` =  orderI.store_key
                   #left join  rd_purchase  as rdpu on rdpu.market = orderI.store_key
		   left join  zmaxx_001.order as zorder on zorder.id =   orderI.order_id 	
                   where        orderI.order_source='redian'  
                           and  orderI.sku_pay>0                    
                           and  orderI.create_dt >=  '2021-05-11 00:00:00' 
                           and  orderI.create_dt <= '2021-05-11 23:59:59'
                           #and  p_stock.kcsl > 0
                   group by orderI.store_key ;


[2021-06-16 10:07:41,602][INFO][zmaxx-etl.db-client] 
select market as store_key ,sum(lsjje)*-1 as payment ,sum(zzk)*-1 as zzk ,sum(jj) as jj  from rd_pss where 
rq  >=  '2021-05-11 00:00:00'
and  rq <= '2021-05-11 23:59:59'
and ( type = 105 or type = 106)
group by market 


[2021-06-16 10:07:41,921][INFO][zmaxx-etl.db-client] 
    select market,sum(kcsl)  as kcsl from rd_product_stock where kcsl > 0 group by market 


[2021-06-16 10:07:41,973][INFO][zmaxx-etl.db-client] 
select  store_key, sum(CAST(sku_qty AS DECIMAL(12,2)) ) as sale_qty_30  from order_item where order_create > DATE_SUB('2021-05-11',INTERVAL 30 DAY)  group by store_key
[2021-06-16 10:07:42,402][INFO][zmaxx-etl.db-client] 
select store_key,COUNT(DISTINCT(customer_key)) as new_u,sum(order_price) as new_u_pay from zmaxx_001.order 
where  customer_key not in
(
select distinct(customer_key) as old_key from zmaxx_001.order   where      order_create  <= '2021-05-11 00:00:00'
)
and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:59:59'
group by store_key 


[2021-06-16 10:07:42,847][INFO][zmaxx-etl.db-client] 
select store_key,count(order_id) as user_null_count from zmaxx_001.order 
where customer_key = 0  and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:59:59'
group by store_key;


[2021-06-16 10:07:42,851][INFO][zmaxx-etl.db-client] 
select store_key,COUNT(DISTINCT(customer_key)) as old_u,sum(order_pay) as old_u_pay from zmaxx_001.order 
where  customer_key   in
(
select distinct(customer_key) as old_key from zmaxx_001.order   where      order_create  <= '2021-05-11 00:00:00'
)
and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:59:59'
group by store_key 

[2021-06-16 10:07:43,291][INFO][zmaxx-etl.sale] in...insert.....
[2021-06-16 10:07:43,292][INFO][zmaxx-etl.sale] ({joint_rate 3.4642857142857144, jj 592.25, order_count 56, store_name 上海（诺亚新天地店）, user_count 15, store_key 10, sku_distinct_count 97, new_user_count 5, calculate_end_date 2021-05-11, stock_turnover_days 48.050640825257894, calculate_begin_date 2021-05-11, old_user_rate 0.765265159518276, kcsl 25619.0, userless_order_rate 0.0, sale_qty 194.0, old_user_count 10, userless_order_count 0, new_user_rate 0.23473484048172405, payment 946.6} {joint_rate 4.084848484848485, jj 2190.53, order_count 165, store_name 浙江（杭州工联大厦店）, user_count 101, store_key 11, sku_distinct_count 151, new_user_count 64, calculate_end_date 2021-05-11, stock_turnover_days 24.33348673109373, calculate_begin_date 2021-05-11, old_user_rate 0.40610069255310877, kcsl 31726.0, userless_order_rate 0.0, sale_qty 674.0, old_user_count 37, userless_order_count 0, new_user_rate 0.5938993074468912, payment 3855.3} {joint_rate 4.102564102564102, jj 1297.27, order_count 39, store_name 浙江（杭州古墩印象城店）, user_count 5, store_key 12, sku_distinct_count 76, new_user_count 3, calculate_end_date 2021-05-11, stock_turnover_days 116.84703433922998, calculate_begin_date 2021-05-11, old_user_rate 0.8051729263700327, kcsl 26201.0, userless_order_rate 0.8717949, sale_qty 160.0, old_user_count 2, userless_order_count 34, new_user_rate 0.1948270736299673, payment 2018.2} {joint_rate 3.925925925925926, jj 395.26, order_count 27, store_name 浙江（杭州绿地店）, user_count 8, store_key 13, sku_distinct_count 64, new_user_count 3, calculate_end_date 2021-05-11, stock_turnover_days 106.17802983602515, calculate_begin_date 2021-05-11, old_user_rate 0.7397560641359463, kcsl 28707.0, userless_order_rate 0.44444445, sale_qty 106.0, old_user_count 5, userless_order_count 12, new_user_rate 0.2602439358640537, payment 729.7} {joint_rate 4.288461538461538, jj 1404.46, order_count 104, store_name 浙江（杭州in77店）, user_count 8, store_key 14, sku_distinct_count 140, new_user_count 0, calculate_end_date 2021-05-11, stock_turnover_days 24.919870871043983, calculate_begin_date 2021-05-11, old_user_rate 1.0, kcsl 28819.0, userless_order_rate 0.9326923, sale_qty 446.0, old_user_count 8, userless_order_count 97, new_user_rate 0.0, payment 2391.0} {joint_rate 1.2, jj 666.3, order_count 5, store_name 江苏（泰州姜堰店）, user_count 3, store_key 17, sku_distinct_count 6, new_user_count 0, calculate_end_date 2021-05-11, stock_turnover_days 361.3858695652174, calculate_begin_date 2021-05-11, old_user_rate 1.0, kcsl 4433.0, userless_order_rate 0.4, sale_qty 6.0, old_user_count 3, userless_order_count 2, new_user_rate 0.0, payment 383.8} {joint_rate 1.6, jj 1391.58, order_count 10, store_name 浙江（慈溪保利店）, user_count 1, store_key 18, sku_distinct_count 16, new_user_count 0, calculate_end_date 2021-05-11, stock_turnover_days 126.63382594417078, calculate_begin_date 2021-05-11, old_user_rate 1.0, kcsl 7712.0, userless_order_rate 1.0, sale_qty 16.0, old_user_count 1, userless_order_count 10, new_user_rate 0.0, payment 1733.4} {joint_rate 2.7, jj 7136.78, order_count 20, store_name 安徽（蚌埠金鹏广场店）, user_count 16, store_key 19, sku_distinct_count 51, new_user_count 5, calculate_end_date 2021-05-11, stock_turnover_days 91.9914346895075, calculate_begin_date 2021-05-11, old_user_rate 0.3847118860301936, kcsl 5728.0, userless_order_rate 0.25, sale_qty 54.0, old_user_count 11, userless_order_count 5, new_user_rate 0.6152881139698064, payment 4703.0} {joint_rate 1.375, jj 688.01, order_count 8, store_name 江苏（淮安玖珑汇店）, user_count 1, store_key 21, sku_distinct_count 10, new_user_count 0, calculate_end_date 2021-05-11, stock_turnover_days 172.32089552238807, calculate_begin_date 2021-05-11, old_user_rate 1.0, kcsl 7697.0, userless_order_rate 1.0, sale_qty 11.0, old_user_count 1, userless_order_count 8, new_user_rate 0.0, payment 811.8} {joint_rate 2.9473684210526314, jj 3006.9, order_count 38, store_name 上海（北上海广场店）, user_count 1, store_key 26, sku_distinct_count 82, new_user_count 0, calculate_end_date 2021-05-11, stock_turnover_days 80.759285860866, calculate_begin_date 2021-05-11, old_user_rate 1.0, kcsl 26236.0, userless_order_rate 0.0, sale_qty 112.0, old_user_count 1, userless_order_count 0, new_user_rate 0.0, payment 3489.0} {joint_rate 4.848484848484849, jj 442.61, order_count 33, store_name 浙江（杭州新天地店）, user_count 1, store_key 27, sku_distinct_count 70, new_user_count 0, calculate_end_date 2021-05-11, stock_turnover_days 67.56091496767777, calculate_begin_date 2021-05-11, old_user_rate 1.0, kcsl 27173.0, userless_order_rate 0.0, sale_qty 160.0, old_user_count 1, userless_order_count 0, new_user_rate 0.0, payment 767.3} {joint_rate 4.222634508348794, jj 6653.47, order_count 539, store_name 江苏（南京新街口店）, user_count 4, store_key 32, sku_distinct_count 229, new_user_count 2, calculate_end_date 2021-05-11, stock_turnover_days 16.489182617370158, calculate_begin_date 2021-05-11, old_user_rate 0.9691740498388248, kcsl 26447.0, userless_order_rate 1.0037106, sale_qty 2276.0, old_user_count 2, userless_order_count 541, new_user_rate 0.03082595016117513, payment 10361.4} {joint_rate 3.0618556701030926, jj 1605.06, order_count 97, store_name 上海（七宝凯德店）, user_count 5, store_key 4, sku_distinct_count 160, new_user_count 1, calculate_end_date 2021-05-11, stock_turnover_days 35.09658570618759, calculate_begin_date 2021-05-11, old_user_rate 0.8951496779082986, kcsl 26829.0, userless_order_rate 0.9587629, sale_qty 297.0, old_user_count 4, userless_order_count 93, new_user_rate 0.10485032209170139, payment 2639.0} {joint_rate 3.36, jj 230.23, order_count 25, store_name 上海（宝山新业坊店）, user_count 5, store_key 5, sku_distinct_count 48, new_user_count 1, calculate_end_date 2021-05-11, stock_turnover_days 33.01081555100848, calculate_begin_date 2021-05-11, old_user_rate 0.8944565480513194, kcsl 11293.0, userless_order_rate 0.84, sale_qty 84.0, old_user_count 4, userless_order_count 21, new_user_rate 0.1055434519486807, payment 413.1} {joint_rate 3.423076923076923, jj 766.06, order_count 52, store_name 上海（桃浦新邻天地店）, user_count 4, store_key 6, sku_distinct_count 85, new_user_count 0, calculate_end_date 2021-05-11, stock_turnover_days 58.62507018528916, calculate_begin_date 2021-05-11, old_user_rate 1.0, kcsl 27843.0, userless_order_rate 0.9423077, sale_qty 178.0, old_user_count 4, userless_order_count 49, new_user_rate 0.0, payment 1142.2})
[2021-06-16 10:07:43,292][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (10, '上海（诺亚新天地店）', 946.6, 592.25, 194.0, 25619.0, 48.050640825257894, 97, 56, 3.4642857142857144, null, 5,
                                      0.23473484048172405,   10, 0.765265159518276, 0.0, 
                                     '0', '2021-05-11');


[2021-06-16 10:07:43,294][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:07:43,294][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (11, '浙江（杭州工联大厦店）', 3855.3, 2190.53, 674.0, 31726.0, 24.33348673109373, 151, 165, 4.084848484848485, null, 64,
                                      0.5938993074468912,   37, 0.40610069255310877, 0.0, 
                                     '0', '2021-05-11');


[2021-06-16 10:07:43,296][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:07:43,296][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (12, '浙江（杭州古墩印象城店）', 2018.2, 1297.27, 160.0, 26201.0, 116.84703433922998, 76, 39, 4.102564102564102, null, 3,
                                      0.1948270736299673,   2, 0.8051729263700327, 0.8717949, 
                                     '34', '2021-05-11');


[2021-06-16 10:07:43,298][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:07:43,298][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (13, '浙江（杭州绿地店）', 729.7, 395.26, 106.0, 28707.0, 106.17802983602515, 64, 27, 3.925925925925926, null, 3,
                                      0.2602439358640537,   5, 0.7397560641359463, 0.44444445, 
                                     '12', '2021-05-11');


[2021-06-16 10:07:43,301][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:07:43,301][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (14, '浙江（杭州in77店）', 2391.0, 1404.46, 446.0, 28819.0, 24.919870871043983, 140, 104, 4.288461538461538, null, 0,
                                      0.0,   8, 1.0, 0.9326923, 
                                     '97', '2021-05-11');


[2021-06-16 10:07:43,302][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:07:43,302][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (17, '江苏（泰州姜堰店）', 383.8, 666.3, 6.0, 4433.0, 361.3858695652174, 6, 5, 1.2, null, 0,
                                      0.0,   3, 1.0, 0.4, 
                                     '2', '2021-05-11');


[2021-06-16 10:07:43,304][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:07:43,304][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (18, '浙江（慈溪保利店）', 1733.4, 1391.58, 16.0, 7712.0, 126.63382594417078, 16, 10, 1.6, null, 0,
                                      0.0,   1, 1.0, 1.0, 
                                     '10', '2021-05-11');


[2021-06-16 10:07:43,305][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:07:43,305][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (19, '安徽（蚌埠金鹏广场店）', 4703.0, 7136.78, 54.0, 5728.0, 91.9914346895075, 51, 20, 2.7, null, 5,
                                      0.6152881139698064,   11, 0.3847118860301936, 0.25, 
                                     '5', '2021-05-11');


[2021-06-16 10:07:43,307][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:07:43,307][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (21, '江苏（淮安玖珑汇店）', 811.8, 688.01, 11.0, 7697.0, 172.32089552238807, 10, 8, 1.375, null, 0,
                                      0.0,   1, 1.0, 1.0, 
                                     '8', '2021-05-11');


[2021-06-16 10:07:43,308][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:07:43,308][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (26, '上海（北上海广场店）', 3489.0, 3006.9, 112.0, 26236.0, 80.759285860866, 82, 38, 2.9473684210526314, null, 0,
                                      0.0,   1, 1.0, 0.0, 
                                     '0', '2021-05-11');


[2021-06-16 10:07:43,310][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:07:43,310][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (27, '浙江（杭州新天地店）', 767.3, 442.61, 160.0, 27173.0, 67.56091496767777, 70, 33, 4.848484848484849, null, 0,
                                      0.0,   1, 1.0, 0.0, 
                                     '0', '2021-05-11');


[2021-06-16 10:07:43,311][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:07:43,311][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (32, '江苏（南京新街口店）', 10361.4, 6653.47, 2276.0, 26447.0, 16.489182617370158, 229, 539, 4.222634508348794, null, 2,
                                      0.03082595016117513,   2, 0.9691740498388248, 1.0037106, 
                                     '541', '2021-05-11');


[2021-06-16 10:07:43,312][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:07:43,312][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (4, '上海（七宝凯德店）', 2639.0, 1605.06, 297.0, 26829.0, 35.09658570618759, 160, 97, 3.0618556701030926, null, 1,
                                      0.10485032209170139,   4, 0.8951496779082986, 0.9587629, 
                                     '93', '2021-05-11');


[2021-06-16 10:07:43,314][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:07:43,314][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (5, '上海（宝山新业坊店）', 413.1, 230.23, 84.0, 11293.0, 33.01081555100848, 48, 25, 3.36, null, 1,
                                      0.1055434519486807,   4, 0.8944565480513194, 0.84, 
                                     '21', '2021-05-11');


[2021-06-16 10:07:43,317][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:07:43,318][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (6, '上海（桃浦新邻天地店）', 1142.2, 766.06, 178.0, 27843.0, 58.62507018528916, 85, 52, 3.423076923076923, null, 0,
                                      0.0,   4, 1.0, 0.9423077, 
                                     '49', '2021-05-11');


[2021-06-16 10:07:43,320][ERROR][zmaxx-etl.db-client] Column count doesn't match value count at row 1
[2021-06-16 10:10:47,819][INFO][zmaxx-etl.db-client] 
select  orderI.store_key , 
			   rds.name,   
                          # sum(zorder.order_price) as payment , 
                          # (sum(orderI.sku_pay) - sum(rdp.jj))/sum(orderI.sku_pay) as gross_profit,   
                          # (sum(orderI.sku_pay) - sum(rdp.jj)) as gross,                    
                           sum(orderI.sku_qty) as qty,
                          # sum(rdpu.sl) as purchase_sl,
                           #sum(orderI.sku_pay)/sum(orderI.sku_qty) as unit_merchan_price,
                           sum(rdp.jj) as jj,
                           count(distinct(orderI.order_id))  as order_count,
                           #sum(orderI.sku_pay)/count(distinct(orderI.order_id)) as  unit_order_price,
                           sum(orderI.sku_qty)/count(distinct(orderI.order_id))  as  joint_rate,
                           #AVG(zorder.order_pay) as avg_order_pay,
                           #sum(orderI.sku_pay)/sum(orderI.sku_qty)  as unit_goods_price,
                           count(distinct(orderI.sku_id)) as sku_distinct_count,
                           count(distinct(zorder.customer_key)) as user_count
                   from order_item as orderI
                   left join  rd_product as rdp on rdp.id = orderI.sku_id 
                   left join  rd_store as rds on rds.`id` =  orderI.store_key
                   #left join  rd_purchase  as rdpu on rdpu.market = orderI.store_key
		   left join  zmaxx_001.order as zorder on zorder.id =   orderI.order_id 	
                   where        orderI.order_source='redian'  
                           and  orderI.sku_pay>0                    
                           and  orderI.create_dt >=  '2021-05-11 00:00:00' 
                           and  orderI.create_dt <= '2021-05-11 23:59:59'
                           #and  p_stock.kcsl > 0
                   group by orderI.store_key ;


[2021-06-16 10:10:48,284][INFO][zmaxx-etl.db-client] 
select market as store_key ,sum(lsjje)*-1 as payment ,sum(zzk)*-1 as zzk ,sum(jj) as jj  from rd_pss where 
rq  >=  '2021-05-11 00:00:00'
and  rq <= '2021-05-11 23:59:59'
and ( type = 105 or type = 106)
group by market 


[2021-06-16 10:10:48,622][INFO][zmaxx-etl.db-client] 
    select market,sum(kcsl)  as kcsl from rd_product_stock where kcsl > 0 group by market 


[2021-06-16 10:10:48,675][INFO][zmaxx-etl.db-client] 
select  store_key, sum(CAST(sku_qty AS DECIMAL(12,2)) ) as sale_qty_30  from order_item where order_create > DATE_SUB('2021-05-11',INTERVAL 30 DAY)  group by store_key
[2021-06-16 10:10:49,059][INFO][zmaxx-etl.db-client] 
select store_key,COUNT(DISTINCT(customer_key)) as new_u,sum(order_price) as new_u_pay from zmaxx_001.order 
where  customer_key not in
(
select distinct(customer_key) as old_key from zmaxx_001.order   where      order_create  <= '2021-05-11 00:00:00'
)
and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:59:59'
group by store_key 


[2021-06-16 10:10:49,490][INFO][zmaxx-etl.db-client] 
select store_key,count(order_id) as user_null_count from zmaxx_001.order 
where customer_key = 0  and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:59:59'
group by store_key;


[2021-06-16 10:10:49,494][INFO][zmaxx-etl.db-client] 
select store_key,COUNT(DISTINCT(customer_key)) as old_u,sum(order_pay) as old_u_pay from zmaxx_001.order 
where  customer_key   in
(
select distinct(customer_key) as old_key from zmaxx_001.order   where      order_create  <= '2021-05-11 00:00:00'
)
and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:59:59'
group by store_key 

[2021-06-16 10:10:49,902][INFO][zmaxx-etl.sale] in...insert.....
[2021-06-16 10:10:49,904][INFO][zmaxx-etl.sale] ({joint_rate 3.4642857142857144, jj 592.25, order_count 56, store_name 上海（诺亚新天地店）, user_count 15, store_key 10, sku_distinct_count 97, new_user_count 5, calculate_end_date 2021-05-11, stock_turnover_days 48.050640825257894, calculate_begin_date 2021-05-11, old_user_rate 0.765265159518276, kcsl 25619.0, userless_order_rate 0.0, sale_qty 194.0, old_user_count 10, userless_order_count 0, new_user_rate 0.23473484048172405, payment 946.6} {joint_rate 4.084848484848485, jj 2190.53, order_count 165, store_name 浙江（杭州工联大厦店）, user_count 101, store_key 11, sku_distinct_count 151, new_user_count 64, calculate_end_date 2021-05-11, stock_turnover_days 24.33348673109373, calculate_begin_date 2021-05-11, old_user_rate 0.40610069255310877, kcsl 31726.0, userless_order_rate 0.0, sale_qty 674.0, old_user_count 37, userless_order_count 0, new_user_rate 0.5938993074468912, payment 3855.3} {joint_rate 4.102564102564102, jj 1297.27, order_count 39, store_name 浙江（杭州古墩印象城店）, user_count 5, store_key 12, sku_distinct_count 76, new_user_count 3, calculate_end_date 2021-05-11, stock_turnover_days 116.84703433922998, calculate_begin_date 2021-05-11, old_user_rate 0.8051729263700327, kcsl 26201.0, userless_order_rate 0.8717949, sale_qty 160.0, old_user_count 2, userless_order_count 34, new_user_rate 0.1948270736299673, payment 2018.2} {joint_rate 3.925925925925926, jj 395.26, order_count 27, store_name 浙江（杭州绿地店）, user_count 8, store_key 13, sku_distinct_count 64, new_user_count 3, calculate_end_date 2021-05-11, stock_turnover_days 106.17802983602515, calculate_begin_date 2021-05-11, old_user_rate 0.7397560641359463, kcsl 28707.0, userless_order_rate 0.44444445, sale_qty 106.0, old_user_count 5, userless_order_count 12, new_user_rate 0.2602439358640537, payment 729.7} {joint_rate 4.288461538461538, jj 1404.46, order_count 104, store_name 浙江（杭州in77店）, user_count 8, store_key 14, sku_distinct_count 140, new_user_count 0, calculate_end_date 2021-05-11, stock_turnover_days 24.919870871043983, calculate_begin_date 2021-05-11, old_user_rate 1.0, kcsl 28819.0, userless_order_rate 0.9326923, sale_qty 446.0, old_user_count 8, userless_order_count 97, new_user_rate 0.0, payment 2391.0} {joint_rate 1.2, jj 666.3, order_count 5, store_name 江苏（泰州姜堰店）, user_count 3, store_key 17, sku_distinct_count 6, new_user_count 0, calculate_end_date 2021-05-11, stock_turnover_days 361.3858695652174, calculate_begin_date 2021-05-11, old_user_rate 1.0, kcsl 4433.0, userless_order_rate 0.4, sale_qty 6.0, old_user_count 3, userless_order_count 2, new_user_rate 0.0, payment 383.8} {joint_rate 1.6, jj 1391.58, order_count 10, store_name 浙江（慈溪保利店）, user_count 1, store_key 18, sku_distinct_count 16, new_user_count 0, calculate_end_date 2021-05-11, stock_turnover_days 126.63382594417078, calculate_begin_date 2021-05-11, old_user_rate 1.0, kcsl 7712.0, userless_order_rate 1.0, sale_qty 16.0, old_user_count 1, userless_order_count 10, new_user_rate 0.0, payment 1733.4} {joint_rate 2.7, jj 7136.78, order_count 20, store_name 安徽（蚌埠金鹏广场店）, user_count 16, store_key 19, sku_distinct_count 51, new_user_count 5, calculate_end_date 2021-05-11, stock_turnover_days 91.9914346895075, calculate_begin_date 2021-05-11, old_user_rate 0.3847118860301936, kcsl 5728.0, userless_order_rate 0.25, sale_qty 54.0, old_user_count 11, userless_order_count 5, new_user_rate 0.6152881139698064, payment 4703.0} {joint_rate 1.375, jj 688.01, order_count 8, store_name 江苏（淮安玖珑汇店）, user_count 1, store_key 21, sku_distinct_count 10, new_user_count 0, calculate_end_date 2021-05-11, stock_turnover_days 172.32089552238807, calculate_begin_date 2021-05-11, old_user_rate 1.0, kcsl 7697.0, userless_order_rate 1.0, sale_qty 11.0, old_user_count 1, userless_order_count 8, new_user_rate 0.0, payment 811.8} {joint_rate 2.9473684210526314, jj 3006.9, order_count 38, store_name 上海（北上海广场店）, user_count 1, store_key 26, sku_distinct_count 82, new_user_count 0, calculate_end_date 2021-05-11, stock_turnover_days 80.759285860866, calculate_begin_date 2021-05-11, old_user_rate 1.0, kcsl 26236.0, userless_order_rate 0.0, sale_qty 112.0, old_user_count 1, userless_order_count 0, new_user_rate 0.0, payment 3489.0} {joint_rate 4.848484848484849, jj 442.61, order_count 33, store_name 浙江（杭州新天地店）, user_count 1, store_key 27, sku_distinct_count 70, new_user_count 0, calculate_end_date 2021-05-11, stock_turnover_days 67.56091496767777, calculate_begin_date 2021-05-11, old_user_rate 1.0, kcsl 27173.0, userless_order_rate 0.0, sale_qty 160.0, old_user_count 1, userless_order_count 0, new_user_rate 0.0, payment 767.3} {joint_rate 4.222634508348794, jj 6653.47, order_count 539, store_name 江苏（南京新街口店）, user_count 4, store_key 32, sku_distinct_count 229, new_user_count 2, calculate_end_date 2021-05-11, stock_turnover_days 16.489182617370158, calculate_begin_date 2021-05-11, old_user_rate 0.9691740498388248, kcsl 26447.0, userless_order_rate 1.0037106, sale_qty 2276.0, old_user_count 2, userless_order_count 541, new_user_rate 0.03082595016117513, payment 10361.4} {joint_rate 3.0618556701030926, jj 1605.06, order_count 97, store_name 上海（七宝凯德店）, user_count 5, store_key 4, sku_distinct_count 160, new_user_count 1, calculate_end_date 2021-05-11, stock_turnover_days 35.09658570618759, calculate_begin_date 2021-05-11, old_user_rate 0.8951496779082986, kcsl 26829.0, userless_order_rate 0.9587629, sale_qty 297.0, old_user_count 4, userless_order_count 93, new_user_rate 0.10485032209170139, payment 2639.0} {joint_rate 3.36, jj 230.23, order_count 25, store_name 上海（宝山新业坊店）, user_count 5, store_key 5, sku_distinct_count 48, new_user_count 1, calculate_end_date 2021-05-11, stock_turnover_days 33.01081555100848, calculate_begin_date 2021-05-11, old_user_rate 0.8944565480513194, kcsl 11293.0, userless_order_rate 0.84, sale_qty 84.0, old_user_count 4, userless_order_count 21, new_user_rate 0.1055434519486807, payment 413.1} {joint_rate 3.423076923076923, jj 766.06, order_count 52, store_name 上海（桃浦新邻天地店）, user_count 4, store_key 6, sku_distinct_count 85, new_user_count 0, calculate_end_date 2021-05-11, stock_turnover_days 58.62507018528916, calculate_begin_date 2021-05-11, old_user_rate 1.0, kcsl 27843.0, userless_order_rate 0.9423077, sale_qty 178.0, old_user_count 4, userless_order_count 49, new_user_rate 0.0, payment 1142.2})
[2021-06-16 10:10:49,904][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (10, '上海（诺亚新天地店）', 946.6, 592.25, 194.0, 25619.0, 48.050640825257894, 97, 56, 3.4642857142857144, 15, 5,
                                      0.23473484048172405,   10, 0.765265159518276, 0.0, 0, 
                                     '2021-05-11', '2021-05-11');


[2021-06-16 10:10:49,915][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (11, '浙江（杭州工联大厦店）', 3855.3, 2190.53, 674.0, 31726.0, 24.33348673109373, 151, 165, 4.084848484848485, 101, 64,
                                      0.5938993074468912,   37, 0.40610069255310877, 0.0, 0, 
                                     '2021-05-11', '2021-05-11');


[2021-06-16 10:10:49,918][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (12, '浙江（杭州古墩印象城店）', 2018.2, 1297.27, 160.0, 26201.0, 116.84703433922998, 76, 39, 4.102564102564102, 5, 3,
                                      0.1948270736299673,   2, 0.8051729263700327, 0.8717949, 34, 
                                     '2021-05-11', '2021-05-11');


[2021-06-16 10:10:49,921][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (13, '浙江（杭州绿地店）', 729.7, 395.26, 106.0, 28707.0, 106.17802983602515, 64, 27, 3.925925925925926, 8, 3,
                                      0.2602439358640537,   5, 0.7397560641359463, 0.44444445, 12, 
                                     '2021-05-11', '2021-05-11');


[2021-06-16 10:10:49,925][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (14, '浙江（杭州in77店）', 2391.0, 1404.46, 446.0, 28819.0, 24.919870871043983, 140, 104, 4.288461538461538, 8, 0,
                                      0.0,   8, 1.0, 0.9326923, 97, 
                                     '2021-05-11', '2021-05-11');


[2021-06-16 10:10:49,928][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (17, '江苏（泰州姜堰店）', 383.8, 666.3, 6.0, 4433.0, 361.3858695652174, 6, 5, 1.2, 3, 0,
                                      0.0,   3, 1.0, 0.4, 2, 
                                     '2021-05-11', '2021-05-11');


[2021-06-16 10:10:49,930][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (18, '浙江（慈溪保利店）', 1733.4, 1391.58, 16.0, 7712.0, 126.63382594417078, 16, 10, 1.6, 1, 0,
                                      0.0,   1, 1.0, 1.0, 10, 
                                     '2021-05-11', '2021-05-11');


[2021-06-16 10:10:49,933][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (19, '安徽（蚌埠金鹏广场店）', 4703.0, 7136.78, 54.0, 5728.0, 91.9914346895075, 51, 20, 2.7, 16, 5,
                                      0.6152881139698064,   11, 0.3847118860301936, 0.25, 5, 
                                     '2021-05-11', '2021-05-11');


[2021-06-16 10:10:49,935][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (21, '江苏（淮安玖珑汇店）', 811.8, 688.01, 11.0, 7697.0, 172.32089552238807, 10, 8, 1.375, 1, 0,
                                      0.0,   1, 1.0, 1.0, 8, 
                                     '2021-05-11', '2021-05-11');


[2021-06-16 10:10:49,937][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (26, '上海（北上海广场店）', 3489.0, 3006.9, 112.0, 26236.0, 80.759285860866, 82, 38, 2.9473684210526314, 1, 0,
                                      0.0,   1, 1.0, 0.0, 0, 
                                     '2021-05-11', '2021-05-11');


[2021-06-16 10:10:49,939][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (27, '浙江（杭州新天地店）', 767.3, 442.61, 160.0, 27173.0, 67.56091496767777, 70, 33, 4.848484848484849, 1, 0,
                                      0.0,   1, 1.0, 0.0, 0, 
                                     '2021-05-11', '2021-05-11');


[2021-06-16 10:10:49,941][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (32, '江苏（南京新街口店）', 10361.4, 6653.47, 2276.0, 26447.0, 16.489182617370158, 229, 539, 4.222634508348794, 4, 2,
                                      0.03082595016117513,   2, 0.9691740498388248, 1.0037106, 541, 
                                     '2021-05-11', '2021-05-11');


[2021-06-16 10:10:49,947][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (4, '上海（七宝凯德店）', 2639.0, 1605.06, 297.0, 26829.0, 35.09658570618759, 160, 97, 3.0618556701030926, 5, 1,
                                      0.10485032209170139,   4, 0.8951496779082986, 0.9587629, 93, 
                                     '2021-05-11', '2021-05-11');


[2021-06-16 10:10:49,949][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (5, '上海（宝山新业坊店）', 413.1, 230.23, 84.0, 11293.0, 33.01081555100848, 48, 25, 3.36, 5, 1,
                                      0.1055434519486807,   4, 0.8944565480513194, 0.84, 21, 
                                     '2021-05-11', '2021-05-11');


[2021-06-16 10:10:49,951][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (6, '上海（桃浦新邻天地店）', 1142.2, 766.06, 178.0, 27843.0, 58.62507018528916, 85, 52, 3.423076923076923, 4, 0,
                                      0.0,   4, 1.0, 0.9423077, 49, 
                                     '2021-05-11', '2021-05-11');


[2021-06-16 17:30:31,724][INFO][zmaxx-etl.db-client] 
select  orderI.store_key , 
			   rds.name,   
                          # sum(zorder.order_price) as payment , 
                          # (sum(orderI.sku_pay) - sum(rdp.jj))/sum(orderI.sku_pay) as gross_profit,   
                          # (sum(orderI.sku_pay) - sum(rdp.jj)) as gross,                    
                           sum(orderI.sku_qty) as qty,
                          # sum(rdpu.sl) as purchase_sl,
                           #sum(orderI.sku_pay)/sum(orderI.sku_qty) as unit_merchan_price,
                           sum(rdp.jj) as jj,
                           count(distinct(orderI.order_id))  as order_count,
                           #sum(orderI.sku_pay)/count(distinct(orderI.order_id)) as  unit_order_price,
                           sum(orderI.sku_qty)/count(distinct(orderI.order_id))  as  joint_rate,
                           #AVG(zorder.order_pay) as avg_order_pay,
                           #sum(orderI.sku_pay)/sum(orderI.sku_qty)  as unit_goods_price,
                           count(distinct(orderI.sku_id)) as sku_distinct_count,
                           count(distinct(zorder.customer_key)) as user_count
                   from order_item as orderI
                   left join  rd_product as rdp on rdp.id = orderI.sku_id 
                   left join  rd_store as rds on rds.`id` =  orderI.store_key
                   #left join  rd_purchase  as rdpu on rdpu.market = orderI.store_key
		   left join  zmaxx_001.order as zorder on zorder.id =   orderI.order_id 	
                   where        orderI.order_source='redian'  
                           and  orderI.sku_pay>0                    
                           and  orderI.create_dt >=  '2021-05-11 00:00:00' 
                           and  orderI.create_dt <= '2021-05-11 23:00:00'
                           #and  p_stock.kcsl > 0
                   group by orderI.store_key ;


[2021-06-16 17:30:31,751][INFO][com.mchange.v2.log.MLog] MLog clients using log4j logging.
[2021-06-16 17:30:32,124][INFO][com.mchange.v2.c3p0.C3P0Registry] Initializing c3p0-0.9.2.1 [built 20-March-2013 10:47:27 +0000; debug? true; trace: 10]
[2021-06-16 17:30:32,186][INFO][com.mchange.v2.c3p0.impl.AbstractPoolBackedDataSource] Initializing c3p0 pool... com.mchange.v2.c3p0.ComboPooledDataSource [ acquireIncrement -> 2, acquireRetryAttempts -> 30, acquireRetryDelay -> 1000, autoCommitOnClose -> false, automaticTestTable -> null, breakAfterAcquireFailure -> false, checkoutTimeout -> 0, connectionCustomizerClassName -> null, connectionTesterClassName -> com.mchange.v2.c3p0.impl.DefaultConnectionTester, dataSourceName -> 1bqpqtiai5lco7s1ejj01g|6e5a7353, debugUnreturnedConnectionStackTraces -> false, description -> null, driverClass -> null, factoryClassLocation -> null, forceIgnoreUnresolvedTransactions -> false, identityToken -> 1bqpqtiai5lco7s1ejj01g|6e5a7353, idleConnectionTestPeriod -> 10, initialPoolSize -> 1, jdbcUrl -> jdbc:mysql://127.0.0.1:3306/zmaxx_001?zeroDateTimeBehavior=convertToNull, maxAdministrativeTaskTime -> 0, maxConnectionAge -> 0, maxIdleTime -> 50, maxIdleTimeExcessConnections -> 0, maxPoolSize -> 50, maxStatements -> 5, maxStatementsPerConnection -> 100, minPoolSize -> 1, numHelperThreads -> 3, preferredTestQuery -> select 1, properties -> {user=******, password=******}, propertyCycle -> 0, statementCacheNumDeferredCloseThreads -> 0, testConnectionOnCheckin -> false, testConnectionOnCheckout -> false, unreturnedConnectionTimeout -> 0, userOverrides -> {}, usesTraditionalReflectiveProxies -> false ]
[2021-06-16 17:30:33,628][INFO][zmaxx-etl.db-client] 
select market as store_key ,sum(lsjje)*-1 as payment ,sum(zzk)*-1 as zzk ,sum(jj) as jj  from rd_pss where 
rq  >=  '2021-05-11 00:00:00'
and  rq <= '2021-05-11 23:00:00'
and ( type = 105 or type = 106)
group by market 


[2021-06-16 17:30:34,223][INFO][zmaxx-etl.db-client] 
    select market,sum(kcsl)  as kcsl from rd_product_stock where kcsl > 0 group by market 


[2021-06-16 17:30:34,359][INFO][zmaxx-etl.db-client] 
select  store_key, sum(CAST(sku_qty AS DECIMAL(12,2)) ) as sale_qty_30  from order_item where order_create > DATE_SUB('2021-05-11',INTERVAL 30 DAY)  group by store_key
[2021-06-16 17:30:34,734][INFO][zmaxx-etl.db-client] 
select store_key,COUNT(DISTINCT(customer_key)) as new_u,sum(order_price) as new_u_pay from zmaxx_001.order 
where  customer_key not in
(
select distinct(customer_key) as old_key from zmaxx_001.order   where      order_create  <= '2021-05-11 00:00:00'
)
and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:00:00'
group by store_key 


[2021-06-16 17:30:35,300][INFO][zmaxx-etl.db-client] 
select store_key,count(order_id) as user_null_count from zmaxx_001.order 
where customer_key = 0  and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:00:00'
group by store_key;


[2021-06-16 17:30:35,306][INFO][zmaxx-etl.db-client] 
select store_key,COUNT(DISTINCT(customer_key)) as old_u,sum(order_pay) as old_u_pay from zmaxx_001.order 
where  customer_key   in
(
select distinct(customer_key) as old_key from zmaxx_001.order   where      order_create  <= '2021-05-11 00:00:00'
)
and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:00:00'
group by store_key 

[2021-06-16 17:45:50,488][INFO][zmaxx-etl.db-client] 
select  orderI.store_key , 
			   rds.name,   
                          # sum(zorder.order_price) as payment , 
                          # (sum(orderI.sku_pay) - sum(rdp.jj))/sum(orderI.sku_pay) as gross_profit,   
                          # (sum(orderI.sku_pay) - sum(rdp.jj)) as gross,                    
                           sum(orderI.sku_qty) as qty,
                          # sum(rdpu.sl) as purchase_sl,
                           #sum(orderI.sku_pay)/sum(orderI.sku_qty) as unit_merchan_price,
                           sum(rdp.jj) as jj,
                           count(distinct(orderI.order_id))  as order_count,
                           #sum(orderI.sku_pay)/count(distinct(orderI.order_id)) as  unit_order_price,
                           sum(orderI.sku_qty)/count(distinct(orderI.order_id))  as  joint_rate,
                           #AVG(zorder.order_pay) as avg_order_pay,
                           #sum(orderI.sku_pay)/sum(orderI.sku_qty)  as unit_goods_price,
                           count(distinct(orderI.sku_id)) as sku_distinct_count,
                           count(distinct(zorder.customer_key)) as user_count
                   from order_item as orderI
                   left join  rd_product as rdp on rdp.id = orderI.sku_id 
                   left join  rd_store as rds on rds.`id` =  orderI.store_key
                   #left join  rd_purchase  as rdpu on rdpu.market = orderI.store_key
		   left join  zmaxx_001.order as zorder on zorder.id =   orderI.order_id 	
                   where        orderI.order_source='redian'  
                           and  orderI.sku_pay>0                    
                           and  orderI.create_dt >=  '2021-05-11 00:00:00' 
                           and  orderI.create_dt <= '2021-05-11 23:00:00'
                           #and  p_stock.kcsl > 0
                   group by orderI.store_key ;


[2021-06-16 17:45:51,099][INFO][zmaxx-etl.db-client] 
select market as store_key ,sum(lsjje)*-1 as payment ,sum(zzk)*-1 as zzk ,sum(jj) as jj  from rd_pss where 
rq  >=  '2021-05-11 00:00:00'
and  rq <= '2021-05-11 23:00:00'
and ( type = 105 or type = 106)
group by market 


[2021-06-16 17:45:51,428][INFO][zmaxx-etl.db-client] 
    select market,sum(kcsl)  as kcsl from rd_product_stock where kcsl > 0 group by market 


[2021-06-16 17:45:51,566][INFO][zmaxx-etl.db-client] 
select  store_key, sum(CAST(sku_qty AS DECIMAL(12,2)) ) as sale_qty_30  from order_item where order_create > DATE_SUB('2021-05-11',INTERVAL 30 DAY)  group by store_key
[2021-06-16 17:45:51,920][INFO][zmaxx-etl.db-client] 
select store_key,COUNT(DISTINCT(customer_key)) as new_u,sum(order_price) as new_u_pay from zmaxx_001.order 
where  customer_key not in
(
select distinct(customer_key) as old_key from zmaxx_001.order   where      order_create  <= '2021-05-11 00:00:00'
)
and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:00:00'
group by store_key 


[2021-06-16 17:45:52,395][INFO][zmaxx-etl.db-client] 
select store_key,count(order_id) as user_null_count from zmaxx_001.order 
where customer_key = 0  and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:00:00'
group by store_key;


[2021-06-16 17:45:52,400][INFO][zmaxx-etl.db-client] 
select store_key,COUNT(DISTINCT(customer_key)) as old_u,sum(order_pay) as old_u_pay from zmaxx_001.order 
where  customer_key   in
(
select distinct(customer_key) as old_key from zmaxx_001.order   where      order_create  <= '2021-05-11 00:00:00'
)
and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:00:00'
group by store_key 

[2021-06-16 17:46:30,549][INFO][zmaxx-etl.db-client] 
select  orderI.store_key , 
			   rds.name,   
                          # sum(zorder.order_price) as payment , 
                          # (sum(orderI.sku_pay) - sum(rdp.jj))/sum(orderI.sku_pay) as gross_profit,   
                          # (sum(orderI.sku_pay) - sum(rdp.jj)) as gross,                    
                           sum(orderI.sku_qty) as qty,
                          # sum(rdpu.sl) as purchase_sl,
                           #sum(orderI.sku_pay)/sum(orderI.sku_qty) as unit_merchan_price,
                           sum(rdp.jj) as jj,
                           count(distinct(orderI.order_id))  as order_count,
                           #sum(orderI.sku_pay)/count(distinct(orderI.order_id)) as  unit_order_price,
                           sum(orderI.sku_qty)/count(distinct(orderI.order_id))  as  joint_rate,
                           #AVG(zorder.order_pay) as avg_order_pay,
                           #sum(orderI.sku_pay)/sum(orderI.sku_qty)  as unit_goods_price,
                           count(distinct(orderI.sku_id)) as sku_distinct_count,
                           count(distinct(zorder.customer_key)) as user_count
                   from order_item as orderI
                   left join  rd_product as rdp on rdp.id = orderI.sku_id 
                   left join  rd_store as rds on rds.`id` =  orderI.store_key
                   #left join  rd_purchase  as rdpu on rdpu.market = orderI.store_key
		   left join  zmaxx_001.order as zorder on zorder.id =   orderI.order_id 	
                   where        orderI.order_source='redian'  
                           and  orderI.sku_pay>0                    
                           and  orderI.create_dt >=  '2021-05-11 00:00:00' 
                           and  orderI.create_dt <= '2021-05-11 23:59:59'
                           #and  p_stock.kcsl > 0
                   group by orderI.store_key ;


[2021-06-16 17:46:31,072][INFO][zmaxx-etl.db-client] 
select market as store_key ,sum(lsjje)*-1 as payment ,sum(zzk)*-1 as zzk ,sum(jj) as jj  from rd_pss where 
rq  >=  '2021-05-11 00:00:00'
and  rq <= '2021-05-11 23:59:59'
and ( type = 105 or type = 106)
group by market 


[2021-06-16 17:46:31,379][INFO][zmaxx-etl.db-client] 
    select market,sum(kcsl)  as kcsl from rd_product_stock where kcsl > 0 group by market 


[2021-06-16 17:46:31,495][INFO][zmaxx-etl.db-client] 
select  store_key, sum(CAST(sku_qty AS DECIMAL(12,2)) ) as sale_qty_30  from order_item where order_create > DATE_SUB('2021-05-11',INTERVAL 30 DAY)  group by store_key
[2021-06-16 17:46:31,857][INFO][zmaxx-etl.db-client] 
select store_key,COUNT(DISTINCT(customer_key)) as new_u,sum(order_price) as new_u_pay from zmaxx_001.order 
where  customer_key not in
(
select distinct(customer_key) as old_key from zmaxx_001.order   where      order_create  <= '2021-05-11 00:00:00'
)
and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:59:59'
group by store_key 


[2021-06-16 17:46:32,297][INFO][zmaxx-etl.db-client] 
select store_key,count(order_id) as user_null_count from zmaxx_001.order 
where customer_key = 0  and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:59:59'
group by store_key;


[2021-06-16 17:46:32,301][INFO][zmaxx-etl.db-client] 
select store_key,COUNT(DISTINCT(customer_key)) as old_u,sum(order_pay) as old_u_pay from zmaxx_001.order 
where  customer_key   in
(
select distinct(customer_key) as old_key from zmaxx_001.order   where      order_create  <= '2021-05-11 00:00:00'
)
and order_create >=  '2021-05-11 00:00:00'  and   order_create  <= '2021-05-11 23:59:59'
group by store_key 

[2021-06-16 17:46:32,724][INFO][zmaxx-etl.sale] in...insert.....
[2021-06-16 17:46:32,737][INFO][zmaxx-etl.sale] ({joint_rate 3.4642857142857144, jj 592.25, order_count 56, store_name 上海（诺亚新天地店）, user_count 15, store_key 10, sku_distinct_count 97, new_user_count 5, calculate_end_date 2021-05-11, stock_turnover_days 48.050640825257894, calculate_begin_date 2021-05-11, old_user_rate 0.765265159518276, new_user_pay 222.2, kcsl 25619.0, userless_order_rate 0.0, sale_qty 194.0, old_user_pay 754.1, old_user_count 10, userless_order_count 0, new_user_rate 0.23473484048172405, payment 946.6} {joint_rate 4.084848484848485, jj 2190.53, order_count 165, store_name 浙江（杭州工联大厦店）, user_count 101, store_key 11, sku_distinct_count 151, new_user_count 64, calculate_end_date 2021-05-11, stock_turnover_days 24.33348673109373, calculate_begin_date 2021-05-11, old_user_rate 0.40610069255310877, new_user_pay 2289.66, kcsl 31726.0, userless_order_rate 0.0, sale_qty 674.0, old_user_pay 1598.6, old_user_count 37, userless_order_count 0, new_user_rate 0.5938993074468912, payment 3855.3} {joint_rate 4.102564102564102, jj 1297.27, order_count 39, store_name 浙江（杭州古墩印象城店）, user_count 5, store_key 12, sku_distinct_count 76, new_user_count 3, calculate_end_date 2021-05-11, stock_turnover_days 116.84703433922998, calculate_begin_date 2021-05-11, old_user_rate 0.8051729263700327, new_user_pay 393.2, kcsl 26201.0, userless_order_rate 0.8717949, sale_qty 160.0, old_user_pay 1664.5, old_user_count 2, userless_order_count 34, new_user_rate 0.1948270736299673, payment 2018.2} {joint_rate 3.925925925925926, jj 395.26, order_count 27, store_name 浙江（杭州绿地店）, user_count 8, store_key 13, sku_distinct_count 64, new_user_count 3, calculate_end_date 2021-05-11, stock_turnover_days 106.17802983602515, calculate_begin_date 2021-05-11, old_user_rate 0.7397560641359463, new_user_pay 189.9, kcsl 28707.0, userless_order_rate 0.44444445, sale_qty 106.0, old_user_pay 539.8, old_user_count 5, userless_order_count 12, new_user_rate 0.2602439358640537, payment 729.7} {joint_rate 4.288461538461538, jj 1404.46, order_count 104, store_name 浙江（杭州in77店）, user_count 8, store_key 14, sku_distinct_count 140, new_user_count 0, calculate_end_date 2021-05-11, stock_turnover_days 24.919870871043983, calculate_begin_date 2021-05-11, old_user_rate 1.0, new_user_pay 0, kcsl 28819.0, userless_order_rate 0.9326923, sale_qty 446.0, old_user_pay 2391.0, old_user_count 8, userless_order_count 97, new_user_rate 0.0, payment 2391.0} {joint_rate 1.2, jj 666.3, order_count 5, store_name 江苏（泰州姜堰店）, user_count 3, store_key 17, sku_distinct_count 6, new_user_count 0, calculate_end_date 2021-05-11, stock_turnover_days 361.3858695652174, calculate_begin_date 2021-05-11, old_user_rate 1.0, new_user_pay 0, kcsl 4433.0, userless_order_rate 0.4, sale_qty 6.0, old_user_pay 383.8, old_user_count 3, userless_order_count 2, new_user_rate 0.0, payment 383.8} {joint_rate 1.6, jj 1391.58, order_count 10, store_name 浙江（慈溪保利店）, user_count 1, store_key 18, sku_distinct_count 16, new_user_count 0, calculate_end_date 2021-05-11, stock_turnover_days 126.63382594417078, calculate_begin_date 2021-05-11, old_user_rate 1.0, new_user_pay 0, kcsl 7712.0, userless_order_rate 1.0, sale_qty 16.0, old_user_pay 1733.4, old_user_count 1, userless_order_count 10, new_user_rate 0.0, payment 1733.4} {joint_rate 2.7, jj 7136.78, order_count 20, store_name 安徽（蚌埠金鹏广场店）, user_count 16, store_key 19, sku_distinct_count 51, new_user_count 5, calculate_end_date 2021-05-11, stock_turnover_days 91.9914346895075, calculate_begin_date 2021-05-11, old_user_rate 0.3847118860301936, new_user_pay 2893.7, kcsl 5728.0, userless_order_rate 0.25, sale_qty 54.0, old_user_pay 2344.4, old_user_count 11, userless_order_count 5, new_user_rate 0.6152881139698064, payment 4703.0} {joint_rate 1.375, jj 688.01, order_count 8, store_name 江苏（淮安玖珑汇店）, user_count 1, store_key 21, sku_distinct_count 10, new_user_count 0, calculate_end_date 2021-05-11, stock_turnover_days 172.32089552238807, calculate_begin_date 2021-05-11, old_user_rate 1.0, new_user_pay 0, kcsl 7697.0, userless_order_rate 1.0, sale_qty 11.0, old_user_pay 822.8, old_user_count 1, userless_order_count 8, new_user_rate 0.0, payment 811.8} {joint_rate 2.9473684210526314, jj 3006.9, order_count 38, store_name 上海（北上海广场店）, user_count 1, store_key 26, sku_distinct_count 82, new_user_count 0, calculate_end_date 2021-05-11, stock_turnover_days 80.759285860866, calculate_begin_date 2021-05-11, old_user_rate 1.0, new_user_pay 0, kcsl 26236.0, userless_order_rate 0.0, sale_qty 112.0, old_user_pay 3557.3, old_user_count 1, userless_order_count 0, new_user_rate 0.0, payment 3489.0} {joint_rate 4.848484848484849, jj 442.61, order_count 33, store_name 浙江（杭州新天地店）, user_count 1, store_key 27, sku_distinct_count 70, new_user_count 0, calculate_end_date 2021-05-11, stock_turnover_days 67.56091496767777, calculate_begin_date 2021-05-11, old_user_rate 1.0, new_user_pay 0, kcsl 27173.0, userless_order_rate 0.0, sale_qty 160.0, old_user_pay 767.3, old_user_count 1, userless_order_count 0, new_user_rate 0.0, payment 767.3} {joint_rate 4.222634508348794, jj 6653.47, order_count 539, store_name 江苏（南京新街口店）, user_count 4, store_key 32, sku_distinct_count 229, new_user_count 2, calculate_end_date 2021-05-11, stock_turnover_days 16.489182617370158, calculate_begin_date 2021-05-11, old_user_rate 0.9691740498388248, new_user_pay 319.4, kcsl 26447.0, userless_order_rate 1.0037106, sale_qty 2276.0, old_user_pay 10383.1, old_user_count 2, userless_order_count 541, new_user_rate 0.03082595016117513, payment 10361.4} {joint_rate 3.0618556701030926, jj 1605.06, order_count 97, store_name 上海（七宝凯德店）, user_count 5, store_key 4, sku_distinct_count 160, new_user_count 1, calculate_end_date 2021-05-11, stock_turnover_days 35.09658570618759, calculate_begin_date 2021-05-11, old_user_rate 0.8951496779082986, new_user_pay 276.7, kcsl 26829.0, userless_order_rate 0.9587629, sale_qty 297.0, old_user_pay 2647.1, old_user_count 4, userless_order_count 93, new_user_rate 0.10485032209170139, payment 2639.0} {joint_rate 3.36, jj 230.23, order_count 25, store_name 上海（宝山新业坊店）, user_count 5, store_key 5, sku_distinct_count 48, new_user_count 1, calculate_end_date 2021-05-11, stock_turnover_days 33.01081555100848, calculate_begin_date 2021-05-11, old_user_rate 0.8944565480513194, new_user_pay 43.6, kcsl 11293.0, userless_order_rate 0.84, sale_qty 84.0, old_user_pay 384.8, old_user_count 4, userless_order_count 21, new_user_rate 0.1055434519486807, payment 413.1} {joint_rate 3.423076923076923, jj 766.06, order_count 52, store_name 上海（桃浦新邻天地店）, user_count 4, store_key 6, sku_distinct_count 85, new_user_count 0, calculate_end_date 2021-05-11, stock_turnover_days 58.62507018528916, calculate_begin_date 2021-05-11, old_user_rate 1.0, new_user_pay 0, kcsl 27843.0, userless_order_rate 0.9423077, sale_qty 178.0, old_user_pay 1288.6, old_user_count 4, userless_order_count 49, new_user_rate 0.0, payment 1142.2})
[2021-06-16 17:46:32,738][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                  
                                     `old_user_pay`,
                                     `new_user_pay`,
                         
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (10, '上海（诺亚新天地店）', 946.6, 592.25, 194.0, 25619.0, 48.050640825257894, 97, 56, 3.4642857142857144, 15, 5,
                                      0.23473484048172405,  10, 0.765265159518276, 0.0, 0, 754.1, 222.2,
                                     '2021-05-11', '2021-05-11');


[2021-06-16 17:46:32,751][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                  
                                     `old_user_pay`,
                                     `new_user_pay`,
                         
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (11, '浙江（杭州工联大厦店）', 3855.3, 2190.53, 674.0, 31726.0, 24.33348673109373, 151, 165, 4.084848484848485, 101, 64,
                                      0.5938993074468912,  37, 0.40610069255310877, 0.0, 0, 1598.6, 2289.66,
                                     '2021-05-11', '2021-05-11');


[2021-06-16 17:46:32,754][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                  
                                     `old_user_pay`,
                                     `new_user_pay`,
                         
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (12, '浙江（杭州古墩印象城店）', 2018.2, 1297.27, 160.0, 26201.0, 116.84703433922998, 76, 39, 4.102564102564102, 5, 3,
                                      0.1948270736299673,  2, 0.8051729263700327, 0.8717949, 34, 1664.5, 393.2,
                                     '2021-05-11', '2021-05-11');


[2021-06-16 17:46:32,758][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                  
                                     `old_user_pay`,
                                     `new_user_pay`,
                         
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (13, '浙江（杭州绿地店）', 729.7, 395.26, 106.0, 28707.0, 106.17802983602515, 64, 27, 3.925925925925926, 8, 3,
                                      0.2602439358640537,  5, 0.7397560641359463, 0.44444445, 12, 539.8, 189.9,
                                     '2021-05-11', '2021-05-11');


[2021-06-16 17:46:32,760][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                  
                                     `old_user_pay`,
                                     `new_user_pay`,
                         
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (14, '浙江（杭州in77店）', 2391.0, 1404.46, 446.0, 28819.0, 24.919870871043983, 140, 104, 4.288461538461538, 8, 0,
                                      0.0,  8, 1.0, 0.9326923, 97, 2391.0, 0,
                                     '2021-05-11', '2021-05-11');


[2021-06-16 17:46:32,763][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                  
                                     `old_user_pay`,
                                     `new_user_pay`,
                         
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (17, '江苏（泰州姜堰店）', 383.8, 666.3, 6.0, 4433.0, 361.3858695652174, 6, 5, 1.2, 3, 0,
                                      0.0,  3, 1.0, 0.4, 2, 383.8, 0,
                                     '2021-05-11', '2021-05-11');


[2021-06-16 17:46:32,766][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                  
                                     `old_user_pay`,
                                     `new_user_pay`,
                         
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (18, '浙江（慈溪保利店）', 1733.4, 1391.58, 16.0, 7712.0, 126.63382594417078, 16, 10, 1.6, 1, 0,
                                      0.0,  1, 1.0, 1.0, 10, 1733.4, 0,
                                     '2021-05-11', '2021-05-11');


[2021-06-16 17:46:32,769][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                  
                                     `old_user_pay`,
                                     `new_user_pay`,
                         
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (19, '安徽（蚌埠金鹏广场店）', 4703.0, 7136.78, 54.0, 5728.0, 91.9914346895075, 51, 20, 2.7, 16, 5,
                                      0.6152881139698064,  11, 0.3847118860301936, 0.25, 5, 2344.4, 2893.7,
                                     '2021-05-11', '2021-05-11');


[2021-06-16 17:46:32,773][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                  
                                     `old_user_pay`,
                                     `new_user_pay`,
                         
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (21, '江苏（淮安玖珑汇店）', 811.8, 688.01, 11.0, 7697.0, 172.32089552238807, 10, 8, 1.375, 1, 0,
                                      0.0,  1, 1.0, 1.0, 8, 822.8, 0,
                                     '2021-05-11', '2021-05-11');


[2021-06-16 17:46:32,777][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                  
                                     `old_user_pay`,
                                     `new_user_pay`,
                         
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (26, '上海（北上海广场店）', 3489.0, 3006.9, 112.0, 26236.0, 80.759285860866, 82, 38, 2.9473684210526314, 1, 0,
                                      0.0,  1, 1.0, 0.0, 0, 3557.3, 0,
                                     '2021-05-11', '2021-05-11');


[2021-06-16 17:46:32,780][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                  
                                     `old_user_pay`,
                                     `new_user_pay`,
                         
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (27, '浙江（杭州新天地店）', 767.3, 442.61, 160.0, 27173.0, 67.56091496767777, 70, 33, 4.848484848484849, 1, 0,
                                      0.0,  1, 1.0, 0.0, 0, 767.3, 0,
                                     '2021-05-11', '2021-05-11');


[2021-06-16 17:46:32,782][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                  
                                     `old_user_pay`,
                                     `new_user_pay`,
                         
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (32, '江苏（南京新街口店）', 10361.4, 6653.47, 2276.0, 26447.0, 16.489182617370158, 229, 539, 4.222634508348794, 4, 2,
                                      0.03082595016117513,  2, 0.9691740498388248, 1.0037106, 541, 10383.1, 319.4,
                                     '2021-05-11', '2021-05-11');


[2021-06-16 17:46:32,784][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                  
                                     `old_user_pay`,
                                     `new_user_pay`,
                         
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (4, '上海（七宝凯德店）', 2639.0, 1605.06, 297.0, 26829.0, 35.09658570618759, 160, 97, 3.0618556701030926, 5, 1,
                                      0.10485032209170139,  4, 0.8951496779082986, 0.9587629, 93, 2647.1, 276.7,
                                     '2021-05-11', '2021-05-11');


[2021-06-16 17:46:32,787][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                  
                                     `old_user_pay`,
                                     `new_user_pay`,
                         
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (5, '上海（宝山新业坊店）', 413.1, 230.23, 84.0, 11293.0, 33.01081555100848, 48, 25, 3.36, 5, 1,
                                      0.1055434519486807,  4, 0.8944565480513194, 0.84, 21, 384.8, 43.6,
                                     '2021-05-11', '2021-05-11');


[2021-06-16 17:46:32,789][INFO][zmaxx-etl.db-client] 
 INSERT INTO `rb_sale` (             `store_key`,
				     `store_name`, 
                                     `payment`,
                                     `jj`,
                                     `sale_qty`,
                                     `kcsl`,
                                     `stock_turnover_days`, 
                                     `sku_distinct_count`,
                                     `order_count`,
                                     `joint_rate`,
                                     `buy_user_count`,
                                     `new_user_count`,
                                     `new_user_rate`,
                                     `old_user_count`,
                                     `old_user_rate`,
                                     `userless_order_rate`,
                                     `userless_order_count`,
                                  
                                     `old_user_pay`,
                                     `new_user_pay`,
                         
                                     `calculate_begin_date`,
                                     `calculate_end_date`
                                     )
                                     VALUES
                                     (6, '上海（桃浦新邻天地店）', 1142.2, 766.06, 178.0, 27843.0, 58.62507018528916, 85, 52, 3.423076923076923, 4, 0,
                                      0.0,  4, 1.0, 0.9423077, 49, 1288.6, 0,
                                     '2021-05-11', '2021-05-11');


